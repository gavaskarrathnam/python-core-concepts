<!DOCTYPE html>
<html data-rh="lang" lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><script async="" src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/branch-latest.js"></script><script async="" src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/analytics.js"></script><script>!function(c,f){var t,o,i,e=[],r={passive:!0,capture:!0},n=new Date,a="pointerup",u="pointercancel";function p(n,e){t||(t=e,o=n,i=new Date,w(f),s())}function s(){0<=o&&o<i-n&&(e.forEach(function(n){n(o,t)}),e=[])}function l(n){if(n.cancelable){var e=(1e12<n.timeStamp?new Date:performance.now())-n.timeStamp;"pointerdown"==n.type?function(n,e){function t(){p(n,e),i()}function o(){i()}function i(){f(a,t,r),f(u,o,r)}c(a,t,r),c(u,o,r)}(e,n):p(e,n)}}function w(e){["click","mousedown","keydown","touchstart","pointerdown"].forEach(function(n){e(n,l,r)})}w(c),self.perfMetrics=self.perfMetrics||{},self.perfMetrics.onFirstInputDelay=function(n){e.push(n),s()}}(addEventListener,removeEventListener)</script><title>How to create a simple ETL Job locally with PySpark, PostgreSQL and Docker</title><meta data-rh="true" charset="utf-8"><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"><meta data-rh="true" name="theme-color" content="#000000"><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"><meta data-rh="true" property="al:ios:app_name" content="Medium"><meta data-rh="true" property="al:ios:app_store_id" content="828256236"><meta data-rh="true" property="al:android:package" content="com.medium.reader"><meta data-rh="true" property="fb:app_id" content="542599432471018"><meta data-rh="true" property="og:site_name" content="Medium"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2019-09-06T11:41:10.612Z"><meta data-rh="true" name="title" content="How to create a simple ETL Job locally with PySpark, PostgreSQL and Docker"><meta data-rh="true" property="og:title" content="How to create a simple ETL Job locally with PySpark, PostgreSQL and Docker"><meta data-rh="true" property="twitter:title" content="How to create a simple ETL Job locally with PySpark, PostgreSQL and Docker"><meta data-rh="true" name="twitter:site" content="@itnext_io"><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/ea53cd43311d"><meta data-rh="true" property="al:android:url" content="medium://p/ea53cd43311d"><meta data-rh="true" property="al:ios:url" content="medium://p/ea53cd43311d"><meta data-rh="true" name="apple-itunes-app" content="app-id=828256236,app-argument=medium://p/ea53cd43311d"><meta data-rh="true" property="al:android:app_name" content="Medium"><meta data-rh="true" name="description" content="In this article, I’m going to demonstrate how Apache Spark can be utilised for writing powerful ETL jobs in Python. If you’re already familiar with Python and working with data from day to day, then…"><meta data-rh="true" property="og:description" content="This article demonstrates how Apache Spark can be utilised for ETL Python."><meta data-rh="true" property="twitter:description" content="This article demonstrates how Apache Spark can be utilised for ETL Python."><meta data-rh="true" property="og:url" content="https://itnext.io/how-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d"><meta data-rh="true" property="al:web:url" content="https://itnext.io/how-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d"><meta data-rh="true" property="og:image" content="https://miro.medium.com/max/1200/1*fTDEt8iL5ck37gWHsJ6_-w.png"><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/max/1200/1*fTDEt8iL5ck37gWHsJ6_-w.png"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="article:author" content="https://itnext.io/@anisboudih"><meta data-rh="true" name="author" content="Anis Boudih"><meta data-rh="true" name="robots" content="index,follow"><meta data-rh="true" name="referrer" content="unsafe-url"><meta data-rh="true" name="twitter:label1" value="Reading time"><meta data-rh="true" name="twitter:data1" value="6 min read"><meta data-rh="true" name="parsely-post-id" content="ea53cd43311d"><link data-rh="true" rel="publisher" href="https://plus.google.com/103654360130207659246"><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="https://itnext.io/osd.xml"><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/152/152/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/120/120/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/76/76/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://cdn-images-1.medium.com/fit/c/60/60/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg" color="#171717"><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/m2.css"><link data-rh="true" rel="author" href="https://itnext.io/@anisboudih"><link data-rh="true" rel="canonical" href="https://itnext.io/how-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d"><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/ea53cd43311d"><script data-rh="true">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-24232453-2', 'auto');
ga('send', 'pageview');</script><style type="text/css" data-fela-rehydration="390" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}</style><style type="text/css" data-fela-rehydration="390" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@-moz-keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@-webkit-keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@-moz-keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@-webkit-keyframes k2{0%{transform:translateY(100%)}90%{transform:translateY(-5%)}100%{transform:translateY(0%)}}@-moz-keyframes k2{0%{transform:translateY(100%)}90%{transform:translateY(-5%)}100%{transform:translateY(0%)}}@keyframes k2{0%{transform:translateY(100%)}90%{transform:translateY(-5%)}100%{transform:translateY(0%)}}@-webkit-keyframes k3{0%{transform:translateY(0%);opacity:1}10%{transform:translateY(-5%);opacity:1}100%{transform:translateY(100%);opacity:0}}@-moz-keyframes k3{0%{transform:translateY(0%);opacity:1}10%{transform:translateY(-5%);opacity:1}100%{transform:translateY(100%);opacity:0}}@keyframes k3{0%{transform:translateY(0%);opacity:1}10%{transform:translateY(-5%);opacity:1}100%{transform:translateY(100%);opacity:0}}@-webkit-keyframes k4{0%{opacity:0}100%{opacity:1}}@-moz-keyframes k4{0%{opacity:0}100%{opacity:1}}@keyframes k4{0%{opacity:0}100%{opacity:1}}</style><style type="text/css" data-fela-rehydration="390" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:fixed}.n{top:0}.o{left:0}.p{right:0}.q{z-index:500}.r{box-shadow:0 4px 12px 0 rgba(0, 0, 0, 0.05)}.v{padding-left:24px}.w{padding-right:24px}.x{margin-left:auto}.y{margin-right:auto}.z{height:65px}.ab{width:100%}.ac{max-width:1080px}.ae{box-sizing:border-box}.af{display:flex}.ag{align-items:center}.aj{flex:1 0 auto}.ak{margin-left:-6px}.al{fill:rgba(0, 0, 0, 0.84)}.am{flex:0 0 auto}.an{margin-left:16px}.ao{font-family:medium-content-sans-serif-font, "Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", Geneva, Arial, sans-serif}.ap{font-style:normal}.aq{line-height:20px}.ar{font-size:15.8px}.as{letter-spacing:0px}.at{color:rgba(0, 0, 0, 0.54)}.au{fill:rgba(0, 0, 0, 0.54)}.av{color:rgba(61, 121, 173, 1)}.aw{fill:rgba(63, 141, 206, 1)}.ax{font-size:inherit}.ay{border:inherit}.az{font-family:inherit}.ba{letter-spacing:inherit}.bb{font-weight:inherit}.bc{padding:0}.bd{margin:0}.be:hover{cursor:pointer}.bf:hover{color:rgba(59, 110, 156, 1)}.bg:hover{fill:rgba(61, 121, 173, 1)}.bh:focus{outline:none}.bi:disabled{cursor:default}.bj:disabled{color:rgba(3, 168, 124, 0.5)}.bk:disabled{fill:rgba(3, 168, 124, 0.5)}.bl{padding:8px 16px}.bm{background:0}.bn{border-color:rgba(63, 141, 206, 1)}.bo:hover{border-color:rgba(61, 121, 173, 1)}.bp{border-radius:4px}.bq{border-width:1px}.br{border-style:solid}.bs{display:inline-block}.bt{text-decoration:none}.bu{border-top:none}.bv{background-color:rgba(26, 113, 177, 1)}.bx{height:54px}.by{overflow:hidden}.bz{margin-right:40px}.ca{height:36px}.cb{width:192px}.cc{overflow:auto}.cd{flex:0 1 auto}.ce{list-style-type:none}.cf{line-height:40px}.cg{white-space:nowrap}.ch{overflow-x:auto}.ci{align-items:flex-start}.cj{margin-top:20px}.ck{padding-top:20px}.cl{height:80px}.cm{height:20px}.cn{margin-right:15px}.co{margin-left:15px}.cp:first-child{margin-left:0}.cq{min-width:1px}.cr{background-color:rgba(191, 218, 246, 1)}.cs{font-weight:300}.ct{font-size:15px}.cu{color:rgba(191, 218, 246, 1)}.cv{text-transform:uppercase}.cw{letter-spacing:1px}.cx{color:inherit}.cy{fill:inherit}.cz:hover{color:rgba(246, 255, 255, 1)}.da:hover{fill:rgba(228, 244, 255, 1)}.db:disabled{color:rgba(142, 183, 224, 1)}.dc:disabled{fill:rgba(142, 183, 224, 1)}.dd{margin-bottom:0px}.de{height:119px}.dh{max-width:728px}.di{flex-direction:column}.dj{opacity:0}.dk{pointer-events:none}.dl{will-change:opacity}.dm{width:131px}.dn{left:50%}.do{transform:translateX(-516px)}.dp{top:calc(65px + 54px + 40px)}.dr{padding-bottom:28px}.ds{border-bottom:1px solid rgba(0, 0, 0, 0.1)}.dt:hover{color:rgba(0, 0, 0, 0.9)}.du:hover{fill:rgba(0, 0, 0, 0.9)}.dv:disabled{color:rgba(0, 0, 0, 0.54)}.dw:disabled{fill:rgba(0, 0, 0, 0.54)}.dx{font-weight:600}.dy{font-size:18px}.dz{color:rgba(0, 0, 0, 0.84)}.ea{padding-bottom:20px}.eb{padding-top:2px}.ec{font-size:16px}.ed{max-height:120px}.ee{text-overflow:ellipsis}.ef{display:-webkit-box}.eg{-webkit-line-clamp:6}.eh{-webkit-box-orient:vertical}.ei{padding:4px 12px}.ej{padding-top:28px}.ek{margin-bottom:19px}.el{margin-left:-5px}.em{margin-right:5px}.en{position:relative}.eo{outline:0}.ep{border:0}.eq{user-select:none}.er{cursor:pointer}.es> svg{pointer-events:none}.et:active{border-style:none}.eu{-webkit-user-select:none}.ev:focus{fill:rgba(61, 121, 173, 1)}.ew{margin-top:5px}.ex button{text-align:left}.ey{margin-top:40px}.ez{clear:both}.fa{justify-content:center}.fg{max-width:680px}.fh{flex-wrap:wrap}.fi{margin-top:25px}.fj{margin-right:8px}.fk{margin-bottom:8px}.fl{border-radius:3px}.fm{padding:5px 10px}.fn{background:rgba(0, 0, 0, 0.05)}.fo{line-height:22px}.fp{margin-top:15px}.fq{justify-content:space-between}.fr{margin-right:16px}.fs{border:1px solid rgba(0, 0, 0, 0.1)}.ft{border-radius:50%}.fu{height:60px}.fv{width:60px}.gi:active{border-style:solid}.gj{background:rgba(255, 255, 255, 1)}.gk{z-index:2}.gl{height:100%}.gm{position:absolute}.go{padding-right:8px}.gp{display:none}.gq{padding-top:32px}.gr{border-top:1px solid rgba(0, 0, 0, 0.1)}.gs{margin-bottom:25px}.gt{margin-bottom:32px}.gu{min-height:80px}.gz{width:80px}.ha{padding-left:102px}.hc{letter-spacing:0.05em}.hd{margin-bottom:6px}.he{font-size:28px}.hf{line-height:36px}.hg{max-width:555px}.hh{max-width:450px}.hi{line-height:24px}.hk{max-width:550px}.hl{padding-top:25px}.hm{padding:20px}.hn{border:1px solid rgba(63, 141, 206, 1)}.ho{text-align:center}.hp{margin-top:64px}.hq{background-color:rgba(0, 0, 0, 0.02)}.hr{max-width:1032px}.hs{padding:60px 0}.ht{background-color:rgba(0, 0, 0, 0.9)}.ik{padding-bottom:48px}.il{border-bottom:1px solid rgba(255, 255, 255, 0.54)}.im{margin:0 -12px}.in{margin:0 12px}.io{flex:1 1 0}.ip{padding-bottom:12px}.iq:hover{color:rgba(255, 255, 255, 0.99)}.ir:hover{fill:rgba(255, 255, 255, 0.99)}.is:disabled{color:rgba(255, 255, 255, 0.7)}.it:disabled{fill:rgba(255, 255, 255, 0.7)}.iu{color:rgba(255, 255, 255, 0.98)}.iv{fill:rgba(255, 255, 255, 0.98)}.iw{text-align:inherit}.ix{font-size:21.6px}.iy{letter-spacing:-0.32px}.iz{color:rgba(255, 255, 255, 0.7)}.ja{fill:rgba(255, 255, 255, 0.7)}.jb{text-decoration:underline}.jc{padding-bottom:8px}.jd{padding-top:8px}.je{width:200px}.jg:hover{text-decoration:underline}.jh{top:calc(100vh + 100px)}.ji{bottom:calc(100vh + 100px)}.jj{width:10px}.jk{word-break:break-word}.jl{word-wrap:break-word}.jm:after{display:block}.jn:after{content:""}.jo:after{clear:both}.jp{margin:0 auto}.jq{line-height:1.23}.jr{letter-spacing:0}.js{font-family:medium-content-title-font, Georgia, Cambria, "Times New Roman", Times, serif}.jt{font-size:40px}.jz{margin-bottom:-0.27em}.ka{line-height:48px}.kb{margin-top:32px}.kc{height:48px}.kd{width:48px}.ke{margin-left:12px}.kf{margin-bottom:2px}.kh{max-height:20px}.ki{-webkit-line-clamp:1}.kj{margin-left:8px}.kk{padding:0px 8px}.kl{border-color:rgba(0, 0, 0, 0.54)}.km:hover{color:rgba(0, 0, 0, 0.97)}.kn:hover{fill:rgba(0, 0, 0, 0.97)}.ko:hover{border-color:rgba(0, 0, 0, 0.84)}.kp:disabled{fill:rgba(0, 0, 0, 0.76)}.kq:disabled{border-color:rgba(0, 0, 0, 0.2)}.kr:disabled{cursor:inherit}.ks:disabled:hover{color:rgba(0, 0, 0, 0.54)}.kt:disabled:hover{fill:rgba(0, 0, 0, 0.76)}.ku:disabled:hover{border-color:rgba(0, 0, 0, 0.2)}.kv{line-height:18px}.kw{max-width:2048px}.lc{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}.ld{cursor:zoom-in}.le{z-index:auto}.lf{transition:opacity 100ms 400ms}.lg{will-change:transform}.lh{transform:translateZ(0)}.li{margin:auto}.lj{background-color:rgba(0, 0, 0, 0.05)}.lk{padding-bottom:18.26171875%}.ll{filter:blur(20px)}.lm{transform:scale(1.1)}.ln{visibility:visible}.lo{line-height:1.58}.lp{letter-spacing:-0.004em}.lq{font-family:medium-content-serif-font, Georgia, Cambria, "Times New Roman", Times, serif}.mb{margin-bottom:-0.46em}.mc{font-weight:700}.md{box-shadow:inset 3px 0 0 0 rgba(0, 0, 0, 0.84)}.me{padding-left:23px}.mf{margin-left:-20px}.mg{font-style:italic}.mh{background-repeat:repeat-x}.mi{background-image:linear-gradient(to right,rgba(0, 0, 0, 0.84) 100%,rgba(0, 0, 0, 0.84) 0);background-image:url('data:image/svg+xml;utf8,<svg preserveAspectRatio="none" viewBox="0 0 1 1" xmlns="http://www.w3.org/2000/svg"><line x1="0" y1="0" x2="1" y2="1" stroke="rgba(0, 0, 0, 0.84)" /></svg>')}.mj{background-size:1px 1px}.mk{background-position:0 1.05em;background-position:0 calc(1em + 1px)}.ml{padding-bottom:NaN%}.mm{padding:2px 4px}.mn{font-size:75%}.mo> strong{font-family:inherit}.mp{font-family:Menlo, Monaco, "Courier New", Courier, monospace}.mq{padding-bottom:7.4281150159744405%}.mr{line-height:1.4}.ms{margin-top:10px}.mv{line-height:1.18}.mw{letter-spacing:-0.022em}.mx{margin-top:-0.09em}.my{margin-bottom:-0.09em}.mz{white-space:pre-wrap}.nn{max-width:2550px}.no{padding-bottom:5px}.np{padding-top:5px}.nq{padding-bottom:14.666666666666666%}.nr{max-width:3358px}.ns{padding-bottom:44.84812388326385%}.nt{list-style-type:disc}.nu{margin-left:30px}.nv{padding-left:0px}</style><style type="text/css" data-fela-rehydration="390" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.ff{margin:0 24px}.ih{padding-left:24px}.ii{padding-right:24px}.ij{max-width:1080px}.jy{margin-top:0.78em}.lb{margin-top:56px}.lz{font-size:21px}.ma{margin-top:2em}.ne{margin-top:1.91em}.nm{max-width:1032px}.oa{margin-top:1.05em}</style><style type="text/css" data-fela-rehydration="390" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ie{padding-left:24px}.if{padding-right:24px}.ig{max-width:1080px}.mt{margin-left:auto}.mu{text-align:center}</style><style type="text/css" data-fela-rehydration="390" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.ib{padding-left:24px}.ic{padding-right:24px}.id{max-width:904px}</style><style type="text/css" data-fela-rehydration="390" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.ah{height:56px}.ai{display:flex}.bw{display:block}.df{margin-bottom:0px}.dg{height:110px}.gv{margin-bottom:24px}.gw{align-items:center}.gx{width:102px}.gy{position:relative}.hb{padding-left:0}.hj{margin-top:24px}.hu{padding:32px 0}.hy{padding-left:24px}.hz{padding-right:24px}.ia{max-width:728px}.jf{width:140px}</style><style type="text/css" data-fela-rehydration="390" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.fb{margin:0 24px}.hv{padding-left:24px}.hw{padding-right:24px}.hx{max-width:552px}.ju{margin-top:0.39em}.kg{margin-bottom:0px}.kx{margin-top:40px}.lr{font-size:18px}.ls{margin-top:1.56em}.na{margin-top:1.41em}.nf{margin:0}.ng{max-width:100%}.nw{margin-top:1.34em}</style><style type="text/css" data-fela-rehydration="390" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.fe{margin:0 24px}.jx{margin-top:0.78em}.la{margin-top:56px}.lx{font-size:21px}.ly{margin-top:2em}.nd{margin-top:1.91em}.nl{max-width:1032px}.nz{margin-top:1.05em}</style><style type="text/css" data-fela-rehydration="390" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.fd{margin:0 24px}.jw{margin-top:0.78em}.kz{margin-top:56px}.lv{font-size:21px}.lw{margin-top:2em}.nc{margin-top:1.91em}.nj{margin:0}.nk{max-width:100%}.ny{margin-top:1.05em}</style><style type="text/css" data-fela-rehydration="390" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.fc{margin:0 24px}.jv{margin-top:0.39em}.ky{margin-top:40px}.lt{font-size:18px}.lu{margin-top:1.56em}.nb{margin-top:1.41em}.nh{margin:0}.ni{max-width:100%}.nx{margin-top:1.34em}</style><style type="text/css" data-fela-rehydration="390" data-fela-type="RULE" media="print">.u{display:none}</style><style type="text/css" data-fela-rehydration="390" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.s{transition:transform 300ms ease}.t{will-change:transform}.dq{transition:opacity 200ms}.fw{transition:border-color 150ms ease}.fx::before{background:
      radial-gradient(circle, rgba(61, 121, 173, 1) 60%, transparent 70%)
    }.fy::before{border-radius:50%}.fz::before{content:""}.ga::before{display:block}.gb::before{z-index:0}.gc::before{left:0}.gd::before{height:100%}.ge::before{position:absolute}.gf::before{top:0}.gg::before{width:100%}.gh:hover::before{animation:k1 2000ms infinite cubic-bezier(.1,.12,.25,1)}.gn{transition:fill 200ms ease}</style><script charset="utf-8" src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/vendorstracing.js"></script><script charset="utf-8" src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/tracing.js"></script><link rel="icon" href="https://miro.medium.com/fit/c/160/160/1*yAqDFIFA5F_NXalOJKz4TA.png" data-rh="true"><script type="application/ld+json" data-rh="true">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1200\u002F1*fTDEt8iL5ck37gWHsJ6_-w.png"],"url":"https:\u002F\u002Fitnext.io\u002Fhow-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d","dateCreated":"2019-09-06T11:36:05.691Z","datePublished":"2019-09-06T11:36:05.691Z","dateModified":"2019-09-06T13:23:44.275Z","headline":"How to create a simple ETL Job locally with PySpark, PostgreSQL and Docker","name":"How to create a simple ETL Job locally with PySpark, PostgreSQL and Docker","description":"In this article, I’m going to demonstrate how Apache Spark can be utilised for writing powerful ETL jobs in Python. If you’re already familiar with Python and working with data from day to day, then…","identifier":"ea53cd43311d","keywords":["Lite:true","Tag:Big Data","Tag:Python","Tag:Pyspark","Tag:Postgresql","Tag:Docker","Topic:Data Science","Topic:Programming","Publication:itnext","Elevated:false","LockedPostSource:LOCKED_POST_SOURCE_UGC_UNENROLLED","LayerCake:3"],"author":{"@type":"Person","name":"Anis Boudih","url":"https:\u002F\u002Fitnext.io\u002F@anisboudih"},"creator":["Anis Boudih"],"publisher":{"@type":"Organization","name":"ITNEXT","url":"itnext.io","logo":{"@type":"ImageObject","width":315,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F394\u002F1*brBJMIxU4BNVrxYigrVEkQ.png"}},"mainEntityOfPage":"https:\u002F\u002Fitnext.io\u002Fhow-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d"}</script><script src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/a.json"></script></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>window.PARSELY = window.PARSELY || {autotrack: false}</script><nav class="l m n o p c q r s t u"><div class="branch-journeys-top"><div class="l c"><section class="v w x y z ab ac ae af ag ah ai"><div class="af ag aj q"><div class="ak l"><a href="https://medium.com/?source=post_page-----ea53cd43311d----------------------" aria-label="Homepage" rel="noopener"><svg width="45" height="45" viewBox="0 0 45 45" class="al"><path d="M5 40V5h35v35H5zm8.56-12.63c0 .56-.03.69-.32 1.03L10.8 31.4v.4h6.97v-.4L15.3 28.4c-.29-.34-.34-.5-.34-1.03v-8.95l6.13 13.36h.71l5.26-13.36v10.64c0 .3 0 .35-.19.53l-1.85 1.8v.4h9.2v-.4l-1.83-1.8c-.18-.18-.2-.24-.2-.53V15.94c0-.3.02-.35.2-.53l1.82-1.8v-.4h-6.47l-4.62 11.55-5.2-11.54h-6.8v.4l2.15 2.63c.24.3.29.37.29.77v10.35z"></path></svg></a></div></div><div class="l am q"><div class="af ag"><div class="af g"><div class="an l"><span class="ao b ap aq ar as l at au"><a href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fitnext.io%2Fhow-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d&amp;source=post_page-----ea53cd43311d---------------------nav_reg-" class="av aw ax ay az ba bb bc bd be bf bg bh bi bj bk" rel="noopener">Sign in</a></span></div></div><div class="an l"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fhow-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d&amp;source=post_page-----ea53cd43311d---------------------nav_reg-" class="bl bm av aw bn bf bg bo be bp ao b ap aq ar as bq br ae bs bt bh" rel="noopener">Get started</a></div></div></div></section></div><div class="bu l bv bw"><section class="v w x y bx ab ac ae by af ag"><div class="bz l am"><a href="https://itnext.io/?source=post_page-----ea53cd43311d----------------------" rel="noopener"><div class="ca cb l"><img alt="ITNEXT" class="" src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/1brBJMIxU4BNVrxYigrVEkQ.png" width="192" height="36"></div></a></div><div class="cc l cd"><ul class="ce bd cf cg ch af ci g cj ck cl"><li class="af ag cm cn co cp"><span class="ao cs ct aq cu cv cw"><a class="cx cy ax ay az ba bb bc bd be cz da bh bi db dc" rel="noopener" href="https://itnext.io/about-itnext-877f4197e8f6?source=post_page-----ea53cd43311d----------------------">About ITNEXT</a></span></li><li class="af ag cm cn co cp"><span class="ao cs ct aq cu cv cw"><a class="cx cy ax ay az ba bb bc bd be cz da bh bi db dc" rel="noopener" href="https://itnext.io/write-for-itnext-4dea1fd3adf?source=post_page-----ea53cd43311d----------------------">Write for ITNEXT</a></span></li><li class="af ag cm cn co cp"><span class="ao cs ct aq cu cv cw"><a class="cx cy ax ay az ba bb bc bd be cz da bh bi db dc" rel="noopener" href="https://itnext.io/itnext-meetups-c28cd668e0bc?source=post_page-----ea53cd43311d----------------------">Meetups</a></span></li><li class="af ag cm cn co cp"><span class="ao cs ct aq cu cv cw"><a class="cx cy ax ay az ba bb bc bd be cz da bh bi db dc" rel="noopener" href="https://itnext.io/itnextsummit-c21f4fabae34?source=post_page-----ea53cd43311d----------------------">SUMMIT</a></span></li><li class="af ag cm cn co cp"><span class="ao cs ct aq cu cv cw"><a href="https://itnext.io/itnext-io-featuredthisweek/home?source=post_page-----ea53cd43311d----------------------" class="cx cy ax ay az ba bb bc bd be cz da bh bi db dc" rel="noopener">Featured </a></span></li><span class="cm cq cr"></span><li class="af ag cm cn co cp"><span class="ao cs ct aq cu cv cw"><a href="https://careers.linkit.nl/?source=post_page-----ea53cd43311d----------------------" class="cx cy ax ay az ba bb bc bd be cz da bh bi db dc" rel="noopener">Vacancies @ LINKIT</a></span></li></ul></div></section></div></div></nav><div class="dd de l df dg"></div><article><section class="v w x y ab dh ae af di"></section><span class="l"></span><div><div class="gm o jh ji jj dk"></div><section class="jk jl jm jn jo"><div class="ae jp ab dh v w"><div><div id="c7b5" class="jq jr dz ap js b jt ju jv jw jx jy jz"><h1 class="js b jt ka dz"><strong class="bb">How to create a simple ETL Job locally with PySpark, PostgreSQL and Docker</strong></h1></div><div class="kb"><div class="ag af"><div><a href="https://itnext.io/@anisboudih?source=post_page-----ea53cd43311d----------------------" rel="noopener"><img alt="Anis Boudih" class="l ft kc kd" src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/2VJ6P-VonuBBjg7Rmam2edA_002.jpg" width="48" height="48"></a></div><div class="ke ab l"><div class="af"><div style="flex: 1 1 0%;"><span class="ao b ap aq ar as l dz al"><div class="kf af ag kg"><span class="ao cs ec aq by kh ee ef ki eh dz"><a href="https://itnext.io/@anisboudih?source=post_page-----ea53cd43311d----------------------" class="cx cy ax ay az ba bb bc bd be jg bh bi dv dw" rel="noopener">Anis Boudih</a></span><div class="kj l am h"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fhow-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d&amp;source=post_page-10bdd399e06b----ea53cd43311d----------------------" class="kk dz al bm kl km kn ko be dv kp kq kr ks kt ku bp ao b ap kv ct as bq br ae bs bt bh" rel="noopener">Follow</a></div></div></span></div></div><span class="ao b ap aq ar as l at au"><span class="ao cs ec aq by kh ee ef ki eh at"><div><a class="cx cy ax ay az ba bb bc bd be jg bh bi dv dw" rel="noopener" href="https://itnext.io/how-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d?source=post_page-----ea53cd43311d----------------------">Sep 6</a> · 6 min read<span style="padding-left: 4px;"><svg class="star-15px_svg__svgIcon-use" width="15" height="15" viewBox="0 0 15 15" style="margin-top: -2px;"><path d="M7.44 2.32c.03-.1.09-.1.12 0l1.2 3.53a.29.29 0 0 0 .26.2h3.88c.11 0 .13.04.04.1L9.8 8.33a.27.27 0 0 0-.1.29l1.2 3.53c.03.1-.01.13-.1.07l-3.14-2.18a.3.3 0 0 0-.32 0L4.2 12.22c-.1.06-.14.03-.1-.07l1.2-3.53a.27.27 0 0 0-.1-.3L2.06 6.16c-.1-.06-.07-.12.03-.12h3.89a.29.29 0 0 0 .26-.19l1.2-3.52z"></path></svg></span></div></span></span></div></div></div></div><figure class="kx ky kz la lb ez x y paragraph-image"><div class="lc ld en le ab"><div class="x y kw"><div class="li l en lj"><div class="lk l"><div class="dj lf gm n o gl ab by lg lh"><img alt="" class="gm n o gl ab ll lm qp qq" src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/1fTDEt8iL5ck37gWHsJ6_-w_002.png" role="presentation" width="2048" height="374"></div><img alt="" class="qn qo gm n o gl ab gj" role="presentation" src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/1fTDEt8iL5ck37gWHsJ6_-w.png" width="2048" height="374"><noscript></noscript></div></div></div></div></figure><p id="462c" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph=""><strong class="lq mc">Introduction</strong></p><p id="a05b" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph="">In
 this article, I’m going to demonstrate how Apache Spark can be utilised
 for writing powerful ETL jobs in Python. If you’re already familiar 
with Python and working with data from day to day, then PySpark is going
 to help you to create more scalable processing and analysis of (big) 
data.</p><p id="a06b" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph="">The
 data that I’ll use is scraped from Ebay-Kleinanzeigen, which is the 
German branch of Ebay where people can advertise their properties. In 
our case, we will work with a dataset that contains information from 
over 370000 used cars; besides, it’s important to note that the content 
of the data is in German.</p><blockquote class="md me mf"><p id="187f" class="lo lp dz mg lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph=""><a href="https://www.kaggle.com/orgesleka/used-cars-database" class="cx bt mh mi mj mk" target="_blank" rel="noopener"><em class="ap">link to data hosted on Kaggle</em></a></p></blockquote><p id="21ad" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph=""><strong class="lq mc">What is Apache Spark</strong></p><p id="4260" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph=""><strong class="lq mc">Apache Spark</strong>
 is one of the most popular engines for large-scale data processing. 
It’s an open source system with an API supporting multiple programming 
languages. Processing of data is done in memory, hence it’s several 
times faster than for example MapReduce. Spark comes with libraries 
supporting a wide range of tasks, such as streaming, machine learning 
and SQL. It’s able to run from your local computer, but also can be 
scaled up to a cluster of hundreds of servers.</p><p id="1c3a" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph=""><strong class="lq mc">What is ETL?</strong></p><p id="5262" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph="">ETL (<strong class="lq mc">E</strong>xtract, <strong class="lq mc">T</strong>ransform and <strong class="lq mc">L</strong>oad)
 is the procedure of migrating data from one system to another. Data 
extraction is the process of retrieving data out of homogeneous or 
heterogeneous sources for further data processing and data storage. 
During data processing, the data is being cleaned and incorrect or 
inaccurate records are being modified or deleted. Finally, the processed
 data is loaded (e.g. stored) into a target database such as a data 
warehouse or data lake.</p><p id="2849" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph=""><strong class="lq mc">Extract</strong></p><p id="1e9e" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph="">The
 starting point of every Spark application is the creation of a 
SparkSession. This is a driver process that maintains all relevant 
information about your Spark Application and it is also responsible for 
distributing and scheduling your application across all executors. We 
can simply create a SparkSession in the following way:</p><figure class="kx ky kz la lb ez"><div class="li l en"><div class="ty l"><iframe src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/94b2413121f8e20e4d8ed7d8229e370b.htm" title="initialize spark" class="gm n o gl ab" scrolling="auto" width="680" height="214" frameborder="0"></iframe></div></div></figure><p id="9264" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph="">The <code class="lj mm mn mo mp b">getOrCreate</code> method will try to get a SparkSession if one is already created, otherwise it will create a new one. With the <code class="lj mm mn mo mp b">master</code>
 option it is possible to specify the master URL that is being 
connected. However, because we’re running our job locally, we will 
specify the <code class="lj mm mn mo mp b"><em class="mg">local[*]</em></code>
 argument. This means that Spark will use as many worker threads as 
logical cores on your machine. We set the application name with the <code class="lj mm mn mo mp b">appName</code> option, this name will appear in the Spark UI and log data.</p><p id="3db2" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph="">Our next step is to read the CSV file. Reading in a CSV can be done with a <code class="lj mm mn mo mp b">DataFrameReader</code>
 that is associated with our SparkSession. In doing so, Spark allows us 
to specify whether schema inference is being used as well as some other 
options:</p><figure class="kx ky kz la lb ez"><div class="li l en"><div class="tx l"><iframe src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/84ba489d68a95f930f7fa80ded462a33.htm" title="load_without_schema.py" class="gm n o gl ab" scrolling="auto" width="680" height="165" frameborder="0"></iframe></div></div></figure><p id="ca49" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph="">Whether
 to choose for schema inference or manually defining a schema depends 
heavily on the use case, in case of writing an ETL job for a production 
environment, it is strongly recommended to define a schema in order to 
prevent inaccurate data representation. Another constraint of schema 
inference is that it tends to make your Spark application slower, 
especially when working with CSV or JSON. Therefore, I’m also showing 
how to read in data with a prior defined schema:</p><figure class="kx ky kz la lb ez"><div class="li l en"><div class="ud l"><iframe src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/41b9dcf15f69aaa7ffe1107c669699d4.htm" title="load_with_schema.py" class="gm n o gl ab" scrolling="auto" width="680" height="764" frameborder="0"></iframe></div></div></figure><p id="d191" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph=""><strong class="lq mc">Transform</strong></p><p id="5af8" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph="">We’re now ready to have a closer look at our data and start to do more interesting stuff:</p></div><div class="ez ab"><figure class="kx ky kz la lb ez ab paragraph-image"><div class="lc ld en le ab"><div class="li l en lj"><div class="mq l"><div class="dj lf gm n o gl ab by lg lh"><img alt="" class="gm n o gl ab ll lm qp qq" src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/1Le-yFQWGfMr-r9Wmt7ntVQ_002.png" role="presentation" width="2504" height="186"></div><img alt="" class="qn qo gm n o gl ab gj" role="presentation" src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/1Le-yFQWGfMr-r9Wmt7ntVQ.png" width="2504" height="186"><noscript></noscript></div></div></div><figcaption class="at ec mr ms ho dh x y mt mu ao cs" data-selectable-paragraph="">First five rows of the car dataset</figcaption></figure></div><div class="ae jp ab dh v w"><p id="70fc" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph="">As you can see, there are multiple columns containing <code class="lj mm mn mo mp b">null</code>
 values. We can handle missing data with a wide variety of options. 
However, discussing this is out of the scope of this article. As a 
result, we choose to leave the missing values as <code class="lj mm mn mo mp b">null</code>. However, there are more strange values and columns in this dataset, so some basic transformations are needed:</p><figure class="kx ky kz la lb ez"><div class="li l en"><div class="ua l"><iframe src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/26daba5574c153cdedfa98f5035de31f.htm" title="clean_drop_data.py" class="gm n o gl ab" scrolling="auto" width="680" height="236" frameborder="0"></iframe></div></div></figure><p id="5d3d" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph="">The rationale for this cleaning is based on the following: the columns <code class="lj mm mn mo mp b">dateCrawled</code> and <code class="lj mm mn mo mp b">lastSeen</code> doesn’t seem to be useful for any future analysis. All the values in the column <code class="lj mm mn mo mp b">nrOfPictures</code> were equal to <code class="lj mm mn mo mp b">0</code>, hence we decided to drop this column.</p><pre class="kx ky kz la lb hm fn ch"><span id="347a" class="mv mw dz ap mp b ec mx my l mz" data-selectable-paragraph=""><strong class="mp mc">seller</strong><br>gewerblich         3<br>privat        371525</span><span id="7989" class="mv mw dz ap mp b ec na nb nc nd ne my l mz" data-selectable-paragraph=""><strong class="mp mc">offerType</strong><br>Angebot    371513<br>Gesuch         12</span></pre><p id="b78d" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph="">Inspecting the columns <code class="lj mm mn mo mp b">seller</code> and <code class="lj mm mn mo mp b">offerType</code> resulted in the following numbers. As a result, we can remove the three rows containing “gewerblich” and then drop the column <code class="lj mm mn mo mp b">seller</code>. The same logic applies also for the column <code class="lj mm mn mo mp b">offerType</code>, consequently we’re left with a more balanced dataset. For the sake of example, we leave the dataset like this:</p></div><div class="ez"><div class="af fa"><div class="nf ng nh ni nj nk fe nl ff nm ab"><figure class="kx ky kz la lb ez no np paragraph-image"><div class="lc ld en le ab"><div class="x y nn"><div class="li l en lj"><div class="nq l"><div class="dj lf gm n o gl ab by lg lh"><img alt="" class="gm n o gl ab ll lm qp qq" src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/14PT02sDjdzEDFNetV-PcOw.png" role="presentation" width="2550" height="374"></div><img alt="" class="qn qo gm n o gl ab gj" role="presentation" src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/14PT02sDjdzEDFNetV-PcOw_002.png" width="2550" height="374"><noscript></noscript></div></div></div></div><figcaption class="at ec mr ms ho dh x y mt mu ao cs" data-selectable-paragraph="">First five rows of the ‘cleaned’ car dataset</figcaption></figure></div></div></div><div class="ae jp ab dh v w"><p id="3c38" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph=""><strong class="lq mc">Load</strong></p><p id="14d5" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph="">We
 have translated our raw data into analysis-ready data, hence we’re 
ready to load our data into our locally running PostgreSQL database for 
further analysis in the nearby future. We have spun up a PostgreSQL 
database with pgAdmin with this basic <a href="https://github.com/klimpie94/pyspark-etl-analytics/blob/master/docker-compose.yml" class="cx bt mh mi mj mk" target="_blank" rel="noopener">docker-compose file</a>.
 This docker-compose configuration file defines all containers in our 
current setup with their corresponding settings. For example, we 
initialised a PostgreSQL database with name<code class="lj mm mn mo mp b">cars</code>, username <code class="lj mm mn mo mp b">admin</code> and password <code class="lj mm mn mo mp b">admin</code>.</p><p id="cdf1" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph=""><strong class="lq mc">Psycopg2</strong>
 is the most popular PostgreSQL database driver for Python. It provides a
 simple and concise way for interacting with a PostgreSQL instance. 
First, we establish a connection to the<code class="lj mm mn mo mp b">cars</code> database:</p><figure class="kx ky kz la lb ez"><div class="li l en"><div class="tz l"><iframe src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/e1f6e51688f0169627666b2ae34b9450.htm" title="postgres_con.py" class="gm n o gl ab" scrolling="auto" width="680" height="192" frameborder="0"></iframe></div></div></figure><p id="b262" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph="">In doing so, we have to provide some general parameters to the <code class="lj mm mn mo mp b">connect</code> function. There is also a possibility to specify the <code class="lj mm mn mo mp b">port</code>, however, in our case there is no need to specify the port, since we’re running the PostgreSQL instance on the default port <code class="lj mm mn mo mp b">5432</code>.
 So, we have our session started and we’re connected to Postgres. After 
having a connection, it’s possible to write our commands (e.g. inserts, 
updates) and <strong class="lq mc">Psycopg2</strong> allows us to do this with <code class="lj mm mn mo mp b">cursors</code>. A cursor is created out of a connection and it will allow you to communicate with PostgreSQL.</p><pre class="kx ky kz la lb hm fn ch"><span id="462f" class="mv mw dz ap mp b ec mx my l mz" data-selectable-paragraph=""># cursor<br>cur = conn.cursor()</span></pre><p id="58c2" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph="">Now that we have created a cursor, we are able to create a table named <code class="lj mm mn mo mp b">cars_table</code> in our <code class="lj mm mn mo mp b">cars</code> database:</p><figure class="kx ky kz la lb ez"><div class="li l en"><div class="ue l"><iframe src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/603a9ed3cc07b86f9bac52f9a5877bd9.htm" title="create_table.py" class="gm n o gl ab" scrolling="auto" width="680" height="434" frameborder="0"></iframe></div></div></figure><p id="f9f4" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph="">After
 creating the table, it’s now ready to be populated with our dataset. We
 can insert our data row by row, by providing our data as a list of 
tuples (where each record is one tuple) to our <code class="lj mm mn mo mp b">INSERT</code> statement:</p><figure class="kx ky kz la lb ez"><div class="li l en"><div class="ug l"><iframe src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/cd7a34bf82340fc607657ce82ed9e09c.htm" title="insert_postgres.py" class="gm n o gl ab" scrolling="auto" width="680" height="297" frameborder="0"></iframe></div></div></figure><p id="f497" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph="">As a result, it is now possible to execute this command with our previously defined cursor:</p><pre class="kx ky kz la lb hm fn ch"><span id="5020" class="mv mw dz ap mp b ec mx my l mz" data-selectable-paragraph="">cur.execute(insert_query, cars_seq)</span></pre><p id="f777" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph="">As you can see, thanks to <strong class="lq mc">Psycopg2</strong>,
 it is really easy to transfer your data from your application to a 
backend database such as PostgreSQL. Lastly, we’re going to query our 
recently populated table with <strong class="lq mc">Psycopg2</strong>:</p><figure class="kx ky kz la lb ez"><div class="li l en"><div class="uf l"><iframe src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/7b2c4e54e758ce0c125068c61c2728ba.htm" title="query_cars.py" class="gm n o gl ab" scrolling="auto" width="680" height="324" frameborder="0"></iframe></div></div></figure><p id="e99e" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph="">Which gives us the following output in our terminal:</p><pre class="kx ky kz la lb hm fn ch"><span id="5f84" class="mv mw dz ap mp b ec mx my l mz" data-selectable-paragraph="">Printing 2 rows<br>Brand =  volkswagen<br>Model =  golf<br>Price  =  480</span><span id="eb4d" class="mv mw dz ap mp b ec na nb nc nd ne my l mz" data-selectable-paragraph="">Brand =  audi<br>Model =  None<br>Price  =  18300</span></pre><p id="ede6" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph="">However, we’re still <em class="mg">missing one important</em> piece of code: <strong class="lq mc">Psycopg </strong>is Python DB-API compliant, so the auto-commit feature is <code class="lj mm mn mo mp b">off</code> by default. As a result, we need to call the following code to commit our transaction to PostgreSQL:</p><pre class="kx ky kz la lb hm fn ch"><span id="d1ac" class="mv mw dz ap mp b ec mx my l mz" data-selectable-paragraph="">conn.commit()</span></pre><p id="7eb8" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph="">And to make sure, we can check in pgAdmin if the dataset is loaded correctly in PostgreSQL:</p><figure class="kx ky kz la lb ez x y paragraph-image"><div class="lc ld en le ab"><div class="x y nr"><div class="li l en lj"><div class="ns l"><div class="dj lf gm n o gl ab by lg lh"><img alt="" class="gm n o gl ab ll lm qp qq" src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/1LbJJyFaLQsWzWdlX7ASDBA_002.png" role="presentation" width="3358" height="1506"></div><img alt="" class="qn qo gm n o gl ab gj" role="presentation" src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/1LbJJyFaLQsWzWdlX7ASDBA.png" width="3358" height="1506"><noscript></noscript></div></div></div></div><figcaption class="at ec mr ms ho dh x y mt mu ao cs" data-selectable-paragraph="">Cars dataset loaded in pgAdmin</figcaption></figure><p id="73ee" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph=""><strong class="lq mc">Final remarks</strong></p><p id="9cd2" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph=""><strong class="lq mc">Pyspark</strong>
 is a powerful and useful (big) data tool for any Data Engineer or Data 
Scientist who is trying to build scalable data applications. I can 
definitely recommend everyone to have a serious look at it and try to 
incorporate it in one of your future projects. Thanks to <strong class="lq mc">Docker</strong>, we were able to spin up a local <strong class="lq mc">PostgreSQL</strong> database without installing anything! The code of this article can be found on <a href="https://github.com/klimpie94/pyspark-etl-analytics" class="cx bt mh mi mj mk" target="_blank" rel="noopener">Github</a>. Please feel free to provide me with any feedback or comments, since this was my first article on a platform.</p><p id="df4a" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph="">Also, feel free to contact me if you’re interested in attending a <a href="https://www.linkit.nl/vacatures/data-engineering/0007529/data-engineering-apprenticeship-starts-feb-1st-2020" class="cx bt mh mi mj mk" target="_blank" rel="noopener">Data Engineering Bootcamp</a> or if you’re just curious about how I experienced these two ‘intense’ months:)</p><p id="c859" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb" data-selectable-paragraph=""><strong class="lq mc">References</strong></p><ul class=""><li id="6a19" class="lo lp dz ap lq b lr ls lt lu lv lw lx ly lz ma mb nt nu nv" data-selectable-paragraph=""><a href="https://spark.apache.org/" class="cx bt mh mi mj mk" target="_blank" rel="noopener">Official Apache Spark website</a></li><li id="f5eb" class="lo lp dz ap lq b lr nw lt nx lv ny lx nz lz oa mb nt nu nv" data-selectable-paragraph="">“Spark: The Definitive Guide by Bill Chambers and Matei Zaharia (O’Reilly). Copyright 2018 Databricks, Inc., 978–1–491–91221–8.”</li><li id="6228" class="lo lp dz ap lq b lr nw lt nx lv ny lx nz lz oa mb nt nu nv" data-selectable-paragraph=""><a href="https://en.wikipedia.org/wiki/Extract,_transform,_load" class="cx bt mh mi mj mk" target="_blank" rel="noopener">What is ETL?</a></li><li id="85a9" class="lo lp dz ap lq b lr nw lt nx lv ny lx nz lz oa mb nt nu nv" data-selectable-paragraph=""><a href="http://initd.org/psycopg/docs/" class="cx bt mh mi mj mk" target="_blank" rel="noopener">Psycopg2 documentation</a></li></ul></div></section></div></article><div class="qn uh dl m dm dn do dp dq e" data-test-id="post-sidebar"><div class="af di"><div class="dr ds l"><a href="https://itnext.io/?source=post_sidebar--------------------------post_sidebar-" class="cx cy ax ay az ba bb bc bd be dt du bh bi dv dw" rel="noopener"><h2 class="ao dx dy aq dz">ITNEXT</h2></a><div class="ea eb l"><h4 class="ao cs ec aq by ed ee ef eg eh at">ITNEXT
 is a platform for IT developers &amp; software engineers to share 
knowledge, connect, collaborate, learn and experience next-gen 
technologies.</h4></div><div class="bs"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fhow-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d&amp;source=post_sidebar--------------------------follow_sidebar-" class="ei bm av aw bn bf bg bo be bp ao b ap aq ar as bq br ae bs bt bh" rel="noopener">Follow</a></div></div><div class="ej ek el af"><div class="af ag"><div class="em l en"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fhow-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d&amp;source=post_sidebar-----ea53cd43311d---------------------clap_sidebar-" class="cx cy ax ay az ba bb bc bd be dt du bh bi dv dw" rel="noopener"><div class="bc eo ep eq er es et ob aw ev bg"><svg width="29" height="29"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM16.82 4.78l1.84-2.56-1.43-.47zM10.38 2.22l1.84 2.56-.41-3.03zM22.38 22.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M9.1 22.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L6.1 15.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L6.4 11.26l-1.18-1.18a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L11.96 14a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L8.43 9.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L20.63 15c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM13 6.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 23 23.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></div><div class="ew l"><div class="ex"><h4 class="ao cs ec aq at"><button class="cx cy ax ay az ba bb bc bd be dt du bh bi dv dw">371 </button></h4></div></div></div></div><div><div class="bs"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fhow-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d&amp;source=post_sidebar--------------------------bookmark_sidebar-" class="cx cy ax ay az ba bb bc bd be dt du bh bi dv dw" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div></div></div></div><div><div class="ey ez af di fa"><div class="af fa"><div class="fb fc fd fe ff fg ab"><div class="af fh"><div class="l"><h4 class="ao cs ct aq at">Thanks to Nils Nieuwenkamp and Kiarash Irandoust.&nbsp;</h4></div></div><div class="af ag fh"></div><div class="fi l"><ul class="bc bd"><li class="bs ce fj fk"><a href="https://itnext.io/tag/big-data" class="fl fm bt at l fn fo a b ct">Big Data</a></li><li class="bs ce fj fk"><a href="https://itnext.io/tag/python" class="fl fm bt at l fn fo a b ct">Python</a></li><li class="bs ce fj fk"><a href="https://itnext.io/tag/pyspark" class="fl fm bt at l fn fo a b ct">Pyspark</a></li><li class="bs ce fj fk"><a href="https://itnext.io/tag/postgresql" class="fl fm bt at l fn fo a b ct">Postgresql</a></li><li class="bs ce fj fk"><a href="https://itnext.io/tag/docker" class="fl fm bt at l fn fo a b ct">Docker</a></li></ul></div><div class="fp af fq u"><div class="af ag"><div class="fr l en"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fhow-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d&amp;source=post_actions_footer-----ea53cd43311d---------------------clap_footer-" class="cx cy ax ay az ba bb bc bd be dt du bh bi dv dw" rel="noopener"><div class="c fs ft af ag fu en fv fw fx fy fz ga gb gc gd ge gf gg gh bo"><div class="bc eo ep eq er es gi ob ag gj ft af fa gk o gl gm n ab aw ev bg gn"><svg width="33" height="33" viewBox="0 0 33 33"><path d="M28.86 17.34l-3.64-6.4c-.3-.43-.71-.73-1.16-.8a1.12 1.12 0 0 0-.9.21c-.62.5-.73 1.18-.32 2.06l1.22 2.6 1.4 2.45c2.23 4.09 1.51 8-2.15 11.66a9.6 9.6 0 0 1-.8.71 6.53 6.53 0 0 0 4.3-2.1c3.82-3.82 3.57-7.87 2.05-10.39zm-6.25 11.08c3.35-3.35 4-6.78 1.98-10.47L21.2 12c-.3-.43-.71-.72-1.16-.8a1.12 1.12 0 0 0-.9.22c-.62.49-.74 1.18-.32 2.06l1.72 3.63a.5.5 0 0 1-.81.57l-8.91-8.9a1.33 1.33 0 0 0-1.89 1.88l5.3 5.3a.5.5 0 0 1-.71.7l-5.3-5.3-1.49-1.49c-.5-.5-1.38-.5-1.88 0a1.34 1.34 0 0 0 0 1.89l1.49 1.5 5.3 5.28a.5.5 0 0 1-.36.86.5.5 0 0 1-.36-.15l-5.29-5.29a1.34 1.34 0 0 0-1.88 0 1.34 1.34 0 0 0 0 1.89l2.23 2.23L9.3 21.4a.5.5 0 0 1-.36.85.5.5 0 0 1-.35-.14l-3.32-3.33a1.33 1.33 0 0 0-1.89 0 1.32 1.32 0 0 0-.39.95c0 .35.14.69.4.94l6.39 6.4c3.53 3.53 8.86 5.3 12.82 1.35zM12.73 9.26l5.68 5.68-.49-1.04c-.52-1.1-.43-2.13.22-2.89l-3.3-3.3a1.34 1.34 0 0 0-1.88 0 1.33 1.33 0 0 0-.4.94c0 .22.07.42.17.61zm14.79 19.18a7.46 7.46 0 0 1-6.41 2.31 7.92 7.92 0 0 1-3.67.9c-3.05 0-6.12-1.63-8.36-3.88l-6.4-6.4A2.31 2.31 0 0 1 2 19.72a2.33 2.33 0 0 1 1.92-2.3l-.87-.87a2.34 2.34 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.64l-.14-.14a2.34 2.34 0 0 1 0-3.3 2.39 2.39 0 0 1 3.3 0l.14.14a2.33 2.33 0 0 1 3.95-1.24l.09.09c.09-.42.29-.83.62-1.16a2.34 2.34 0 0 1 3.3 0l3.38 3.39a2.17 2.17 0 0 1 1.27-.17c.54.08 1.03.35 1.45.76.1-.55.41-1.03.9-1.42a2.12 2.12 0 0 1 1.67-.4 2.8 2.8 0 0 1 1.85 1.25l3.65 6.43c1.7 2.83 2.03 7.37-2.2 11.6zM13.22.48l-1.92.89 2.37 2.83-.45-3.72zm8.48.88L19.78.5l-.44 3.7 2.36-2.84zM16.5 3.3L15.48 0h2.04L16.5 3.3z" fill-rule="evenodd"></path></svg></div></div></a></div><div class="ew l"><div class="ex"><h4 class="ao cs ec aq dz"><button class="cx cy ax ay az ba bb bc bd be dt du bh bi dv dw">371 claps</button></h4></div></div></div><div class="af ag"><div class="go l am g"><a href="https://medium.com/p/ea53cd43311d/share/twitter?source=follow_footer--------------------------follow_footer-" class="cx cy ax ay az ba bb bc bd be dt du bh bi dv dw" target="_blank" rel="noopener"><svg width="29" height="29" class="al"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></a></div><div class="go l am g"><a href="https://medium.com/p/ea53cd43311d/share/facebook?source=follow_footer--------------------------follow_footer-" class="cx cy ax ay az ba bb bc bd be dt du bh bi dv dw" target="_blank" rel="noopener"><svg width="29" height="29" class="al"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></a></div><div class="go gp bw"><div class="bs"><button class="cx cy ax ay az ba bb bc bd be dt du bh bi dv dw"><svg width="25" height="25" class="al"><g fill-rule="evenodd"><path d="M15.6 5a.42.42 0 0 0 .17-.3.42.42 0 0 0-.12-.33l-2.8-2.79a.5.5 0 0 0-.7 0l-2.8 2.8a.4.4 0 0 0-.1.32c0 .12.07.23.16.3h.02a.45.45 0 0 0 .57-.04l2-2V10c0 .28.23.5.5.5s.5-.22.5-.5V2.93l2.02 2.02c.08.07.18.12.3.13.11.01.21-.02.3-.08v.01"></path><path d="M18 7h-1.5a.5.5 0 0 0 0 1h1.6c.5 0 .9.4.9.9v10.2c0 .5-.4.9-.9.9H6.9a.9.9 0 0 1-.9-.9V8.9c0-.5.4-.9.9-.9h1.6a.5.5 0 0 0 .35-.15A.5.5 0 0 0 9 7.5a.5.5 0 0 0-.15-.35A.5.5 0 0 0 8.5 7H7a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h11a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2"></path></g></svg></button></div></div><div class="go l am"><div><div class="bs"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fhow-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d&amp;source=post_actions_footer--------------------------bookmark_sidebar-" class="cx cy ax ay az ba bb bc bd be dt du bh bi dv dw" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div></div></div><div class="bs"><div class="bs"><div class="l am"><button class="cx cy ax ay az ba bb bc bd be dt du bh bi dv dw"><svg width="25" height="25" viewBox="-480.5 272.5 21 21" class="al"><path d="M-463 284.6c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5z"></path></svg></button></div></div></div></div></div><div class="gq gr gs fi l u"><div class="gt gu l en"><span class="l gv ai gw"><div class="l gm gx gy"><a href="https://itnext.io/@anisboudih?source=follow_footer--------------------------follow_footer-" rel="noopener"><img alt="Anis Boudih" class="l ft cl gz" src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/2VJ6P-VonuBBjg7Rmam2edA.jpg" width="80" height="80"></a></div><span class="l"><div class="ha l hb"><p class="ao cs ct aq at cv hc">Written by</p></div><div class="ha hd af hb"><div class="ab af ag fq"><h2 class="ao dx he hf dz"><a href="https://itnext.io/@anisboudih?source=follow_footer--------------------------follow_footer-" class="cx cy ax ay az ba bb bc bd be dt du bh bi dv dw" rel="noopener">Anis Boudih</a></h2><div class="l g"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fhow-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d&amp;source=follow_footer-10bdd399e06b-------------------------follow_footer-" class="ei bm av aw bn bf bg bo be bp ao b ap aq ar as bq br ae bs bt bh" rel="noopener">Follow</a></div></div></div></span></span><div class="ha hg l hb bw"><div class="hh l"><h4 class="ao cs dy hi at">Junior Data Engineer @LINKIT | passionate about Big Data and Machine Learning</h4></div><div class="gp hj bw"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fhow-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d&amp;source=follow_footer-10bdd399e06b-------------------------follow_footer-" class="ei bm av aw bn bf bg bo be bp ao b ap aq ar as bq br ae bs bt bh" rel="noopener">Follow</a></div></div></div><div class="gq l"></div><div class="gt gu l en"><span class="l gv ai gw"><div class="l gm gx gy"><a href="https://itnext.io/?source=follow_footer--------------------------follow_footer-" rel="noopener"><img alt="ITNEXT" class="bp gz cl" src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/1yAqDFIFA5F_NXalOJKz4TA.png" width="80" height="80"></a></div><span class="l"><div class="ha hd af hb"><div class="ab af ag fq"><h2 class="ao dx he hf dz"><a href="https://itnext.io/?source=follow_footer--------------------------follow_footer-" class="cx cy ax ay az ba bb bc bd be dt du bh bi dv dw" rel="noopener">ITNEXT</a></h2><div class="l g"><div class="bs"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fhow-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d&amp;source=follow_footer--------------------------follow_footer-" class="ei bm av aw bn bf bg bo be bp ao b ap aq ar as bq br ae bs bt bh" rel="noopener">Follow</a></div></div></div></div></span></span><div class="ha hk l hb bw"><div class="hh l"><h4 class="ao cs dy hi at">ITNEXT
 is a platform for IT developers &amp; software engineers to share 
knowledge, connect, collaborate, learn and experience next-gen 
technologies.</h4></div><div class="gp hj bw"><div class="bs"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fhow-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d&amp;source=follow_footer--------------------------follow_footer-" class="ei bm av aw bn bf bg bo be bp ao b ap aq ar as bq br ae bs bt bh" rel="noopener">Follow</a></div></div></div></div></div><div class="hl gr l u"><a href="https://medium.com/p/ea53cd43311d/responses/show?source=follow_footer--------------------------follow_footer-" class="cx cy ax ay az ba bb bc bd be dt du bh bi dv dw" rel="noopener"><div class="hm hn fl l ho g"><span class="av">Write the first response</span></div></a></div></div></div><div class="hp l hq u"><div class="af fa"><div class="fb fc fd fe ff hr ab"><div class="qr l qs"><div class="jc ds gt l"><h2 class="ao dx qt qu dz">More From Medium</h2></div><div class="ci af on fh qv qw qx qy qz ra rb rc rd re rf rg rh ri rj"><div class="rk rl rm ng rn ro rp ni rq rr rs nk rt ru rv rw rx ry rz sa sb"><div class="ab gl"><div class="l sc"><div class="sd se qv qw qx sf sg qy qz ra sh si rb rc rd sj sk re rf rg sl sm rh ri rj af fh"><div class="rk rl rm ng rn ro sn so rq rr sp sq rt ru sr ss rx ry st su sb"><div class="pg l sv f"><h4 class="ao cs ec aq at">More from ITNEXT</h4></div><div class="sw l sx qs"><a class="cx cy ax ay az ba bb bc bd be dt du bh bi dv dw l" rel="noopener" href="https://itnext.io/using-the-dom-like-a-pro-163a6c552eba?source=post_recirc---------0------------------"><div class="sy en"><div class="gl gm ab"><div class="sz l ta oy gl ab tb tc"></div></div></div></a></div></div><div class="rk rl rm ng rn ro sn so rq rr sp sq rt ru sr ss rx ry st su sb"><div class="sw l"><div class="td gp h te"><h4 class="ao cs ec aq at">More from ITNEXT</h4></div><a rel="noopener" href="https://itnext.io/using-the-dom-like-a-pro-163a6c552eba?source=post_recirc---------0------------------"><h3 class="dz al js pr ap tf tg th">Using the DOM like a Pro</h3></a></div><div class="af ag fq"><div class="ti l cd"><div class="ag af"><div><a href="https://itnext.io/@dannymoerkerke?source=post_recirc---------0------------------" rel="noopener"><div class="en tj tk"><svg width="46" height="50" viewBox="0 0 46 50" class="qk gm tl tm tn to dk"><path d="M1.45 15.22C5.43 7.07 13.59 1.5 23 1.5v-1C13.18.5 4.69 6.32.55 14.78l.9.44zM23 1.5c9.4 0 17.57 5.57 21.55 13.72l.9-.44C41.3 6.32 32.82.5 23 .5v1zm21.55 33.28C40.57 42.93 32.41 48.5 23 48.5v1c9.82 0 18.31-5.82 22.45-14.28l-.9-.44zM23 48.5c-9.4 0-17.57-5.57-21.55-13.72l-.9.44C4.7 43.68 13.18 49.5 23 49.5v-1z"></path></svg><img alt="Danny Moerkerke" class="l ft tk tj" src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/1LNE7VNHhYk__VDTzO8InnA.jpg" width="40" height="40"></div></a></div><div class="ke ab l"><div class="af"><div style="flex: 1 1 0%;"><span class="ao b ap aq ar as l dz al"><div class="dd af ag kg"><span class="ao cs ec aq by kh ee ef ki eh dz"><a href="https://itnext.io/@dannymoerkerke?source=post_recirc---------0------------------" class="cx cy ax ay az ba bb bc bd be jg bh bi dv dw" rel="noopener">Danny Moerkerke</a><span> in <a href="https://itnext.io/?source=post_recirc---------0------------------" class="cx cy ax ay az ba bb bc bd be jg bh bi dv dw" rel="noopener">ITNEXT</a></span></span></div></span></div></div><span class="ao b ap aq ar as l at au"><span class="ao cs ec aq by kh ee ef ki eh at"><div><a class="cx cy ax ay az ba bb bc bd be jg bh bi dv dw" rel="noopener" href="https://itnext.io/using-the-dom-like-a-pro-163a6c552eba?source=post_recirc---------0------------------">Sep 2</a> · 10 min read<span style="padding-left: 4px;"><svg class="star-15px_svg__svgIcon-use" width="15" height="15" viewBox="0 0 15 15" style="margin-top: -2px;"><path d="M7.44 2.32c.03-.1.09-.1.12 0l1.2 3.53a.29.29 0 0 0 .26.2h3.88c.11 0 .13.04.04.1L9.8 8.33a.27.27 0 0 0-.1.29l1.2 3.53c.03.1-.01.13-.1.07l-3.14-2.18a.3.3 0 0 0-.32 0L4.2 12.22c-.1.06-.14.03-.1-.07l1.2-3.53a.27.27 0 0 0-.1-.3L2.06 6.16c-.1-.06-.07-.12.03-.12h3.89a.29.29 0 0 0 .26-.19l1.2-3.52z"></path></svg></span></div></span></span></div></div></div><div class="af ag"><div class="af ag"><div class="em l en"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fhow-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d&amp;source=post_recirc-----163a6c552eba----0-----------------clap_preview-" class="cx cy ax ay az ba bb bc bd be dt du bh bi dv dw" rel="noopener"><div class="bc eo ep eq er es et ob tp tq tr"><svg width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></div><div class="ew l"><div class="ex"><h4 class="ao cs ec aq at">3.8K </h4></div></div></div><div class="ts ke ti cm tt l"></div><div><div class="bs"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fhow-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d&amp;source=post_recirc---------0-----------------bookmark_sidebar-" class="cx cy ax ay az ba bb bc bd be dt du bh bi dv dw" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div></div></div></div></div></div></div></div></div><div class="rk rl rm ng rn ro rp ni rq rr rs nk rt ru rv rw rx ry rz sa sb"><div class="ab gl"><div class="l sc"><div class="sd se qv qw qx sf sg qy qz ra sh si rb rc rd sj sk re rf rg sl sm rh ri rj af fh"><div class="rk rl rm ng rn ro sn so rq rr sp sq rt ru sr ss rx ry st su sb"><div class="pg l sv f"><h4 class="ao cs ec aq at">More from ITNEXT</h4></div><div class="sw l sx qs"><a class="cx cy ax ay az ba bb bc bd be dt du bh bi dv dw l" rel="noopener" href="https://itnext.io/graphql-fragment-based-approach-to-building-your-components-798647d011a5?source=post_recirc---------1------------------"><div class="sy en"><div class="gl gm ab"><div class="tu l ta oy gl ab tb tc"></div></div></div></a></div></div><div class="rk rl rm ng rn ro sn so rq rr sp sq rt ru sr ss rx ry st su sb"><div class="sw l"><div class="td gp h te"><h4 class="ao cs ec aq at">More from ITNEXT</h4></div><a rel="noopener" href="https://itnext.io/graphql-fragment-based-approach-to-building-your-components-798647d011a5?source=post_recirc---------1------------------"><h3 class="dz al js pr ap tf tg th">GraphQL fragment-based approach to building your components</h3></a></div><div class="af ag fq"><div class="ti l cd"><div class="ag af"><div><a href="https://itnext.io/@dbayarchyk?source=post_recirc---------1------------------" rel="noopener"><img alt="Dzmitry Bayarchyk" class="l ft tk tj" src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/0TMgfMlfI_sgT1-6E.jpg" width="40" height="40"></a></div><div class="ke ab l"><div class="af"><div style="flex: 1 1 0%;"><span class="ao b ap aq ar as l dz al"><div class="dd af ag kg"><span class="ao cs ec aq by kh ee ef ki eh dz"><a href="https://itnext.io/@dbayarchyk?source=post_recirc---------1------------------" class="cx cy ax ay az ba bb bc bd be jg bh bi dv dw" rel="noopener">Dzmitry Bayarchyk</a><span> in <a href="https://itnext.io/?source=post_recirc---------1------------------" class="cx cy ax ay az ba bb bc bd be jg bh bi dv dw" rel="noopener">ITNEXT</a></span></span></div></span></div></div><span class="ao b ap aq ar as l at au"><span class="ao cs ec aq by kh ee ef ki eh at"><div><a class="cx cy ax ay az ba bb bc bd be jg bh bi dv dw" rel="noopener" href="https://itnext.io/graphql-fragment-based-approach-to-building-your-components-798647d011a5?source=post_recirc---------1------------------">Sep 19</a> · 3 min read<span style="padding-left: 4px;"><svg class="star-15px_svg__svgIcon-use" width="15" height="15" viewBox="0 0 15 15" style="margin-top: -2px;"><path d="M7.44 2.32c.03-.1.09-.1.12 0l1.2 3.53a.29.29 0 0 0 .26.2h3.88c.11 0 .13.04.04.1L9.8 8.33a.27.27 0 0 0-.1.29l1.2 3.53c.03.1-.01.13-.1.07l-3.14-2.18a.3.3 0 0 0-.32 0L4.2 12.22c-.1.06-.14.03-.1-.07l1.2-3.53a.27.27 0 0 0-.1-.3L2.06 6.16c-.1-.06-.07-.12.03-.12h3.89a.29.29 0 0 0 .26-.19l1.2-3.52z"></path></svg></span></div></span></span></div></div></div><div class="af ag"><div class="af ag"><div class="em l en"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fhow-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d&amp;source=post_recirc-----798647d011a5----1-----------------clap_preview-" class="cx cy ax ay az ba bb bc bd be dt du bh bi dv dw" rel="noopener"><div class="bc eo ep eq er es et ob tp tq tr"><svg width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></div><div class="ew l"><div class="ex"><h4 class="ao cs ec aq at">183 </h4></div></div></div><div class="ts ke ti cm tt l"></div><div><div class="bs"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fhow-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d&amp;source=post_recirc---------1-----------------bookmark_sidebar-" class="cx cy ax ay az ba bb bc bd be dt du bh bi dv dw" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div></div></div></div></div></div></div></div></div><div class="rk rl rm ng rn ro rp ni rq rr rs nk rt ru rv rw rx ry rz sa sb"><div class="ab gl"><div class="l sc"><div class="sd se qv qw qx sf sg qy qz ra sh si rb rc rd sj sk re rf rg sl sm rh ri rj af fh"><div class="rk rl rm ng rn ro sn so rq rr sp sq rt ru sr ss rx ry st su sb"><div class="pg l sv f"><h4 class="ao cs ec aq at">More from ITNEXT</h4></div><div class="sw l sx qs"><a class="cx cy ax ay az ba bb bc bd be dt du bh bi dv dw l" rel="noopener" href="https://itnext.io/designing-solidjs-reactivity-75180a4c74b4?source=post_recirc---------2------------------"><div class="sy en"><div class="gl gm ab"><div class="tv l ta oy gl ab tb tc"></div></div></div></a></div></div><div class="rk rl rm ng rn ro sn so rq rr sp sq rt ru sr ss rx ry st su sb"><div class="sw l"><div class="td gp h te"><h4 class="ao cs ec aq at">More from ITNEXT</h4></div><a rel="noopener" href="https://itnext.io/designing-solidjs-reactivity-75180a4c74b4?source=post_recirc---------2------------------"><h3 class="dz al js pr ap tf tg th">Designing SolidJS: Reactivity</h3></a></div><div class="af ag fq"><div class="ti l cd"><div class="ag af"><div><a href="https://itnext.io/@ryansolid?source=post_recirc---------2------------------" rel="noopener"><img alt="Ryan Carniato" class="l ft tk tj" src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/1eMR1FyWRupD7Ex07HZykGA.jpg" width="40" height="40"></a></div><div class="ke ab l"><div class="af"><div style="flex: 1 1 0%;"><span class="ao b ap aq ar as l dz al"><div class="dd af ag kg"><span class="ao cs ec aq by kh ee ef ki eh dz"><a href="https://itnext.io/@ryansolid?source=post_recirc---------2------------------" class="cx cy ax ay az ba bb bc bd be jg bh bi dv dw" rel="noopener">Ryan Carniato</a><span> in <a href="https://itnext.io/?source=post_recirc---------2------------------" class="cx cy ax ay az ba bb bc bd be jg bh bi dv dw" rel="noopener">ITNEXT</a></span></span></div></span></div></div><span class="ao b ap aq ar as l at au"><span class="ao cs ec aq by kh ee ef ki eh at"><div><a class="cx cy ax ay az ba bb bc bd be jg bh bi dv dw" rel="noopener" href="https://itnext.io/designing-solidjs-reactivity-75180a4c74b4?source=post_recirc---------2------------------">Sep 19</a> · 12 min read<span style="padding-left: 4px;"><svg class="star-15px_svg__svgIcon-use" width="15" height="15" viewBox="0 0 15 15" style="margin-top: -2px;"><path d="M7.44 2.32c.03-.1.09-.1.12 0l1.2 3.53a.29.29 0 0 0 .26.2h3.88c.11 0 .13.04.04.1L9.8 8.33a.27.27 0 0 0-.1.29l1.2 3.53c.03.1-.01.13-.1.07l-3.14-2.18a.3.3 0 0 0-.32 0L4.2 12.22c-.1.06-.14.03-.1-.07l1.2-3.53a.27.27 0 0 0-.1-.3L2.06 6.16c-.1-.06-.07-.12.03-.12h3.89a.29.29 0 0 0 .26-.19l1.2-3.52z"></path></svg></span></div></span></span></div></div></div><div class="af ag"><div class="af ag"><div class="em l en"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fhow-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d&amp;source=post_recirc-----75180a4c74b4----2-----------------clap_preview-" class="cx cy ax ay az ba bb bc bd be dt du bh bi dv dw" rel="noopener"><div class="bc eo ep eq er es et ob tp tq tr"><svg width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></div><div class="ew l"><div class="ex"><h4 class="ao cs ec aq at">63 </h4></div></div></div><div class="ts ke ti cm tt l"></div><div><div class="bs"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fitnext.io%2Fhow-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d&amp;source=post_recirc---------2-----------------bookmark_sidebar-" class="cx cy ax ay az ba bb bc bd be dt du bh bi dv dw" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="hs l ht hu"><section class="x y ab ae l hv hw hx hy hz ia ib ic id ie if ig ih ii ij"><div class="ik il gt af fq g"><div class="im af fq"><div class="in l io"><div class="ip l"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----ea53cd43311d----------------------" class="cx cy ax ay az ba bb bc bd be iq ir bh bi is it" rel="noopener"><h4 class="iu iv iw ao dx ap hi ix iy l">Discover Medium</h4></a></div><span class="ao b ap aq ar as l iz ja">Welcome to a place where words matter. On Medium, smart voices and original ideas take center stage - with no ads in sight. <a href="https://medium.com/about?autoplay=1&amp;source=post_page-----ea53cd43311d----------------------" class="cx cy ax ay az ba bb bc bd be bh bi is it jb" rel="noopener">Watch</a></span></div><div class="in l io"><div class="jc l"><a href="https://medium.com/topics?source=post_page-----ea53cd43311d----------------------" class="cx cy ax ay az ba bb bc bd be iq ir bh bi is it" rel="noopener"><h4 class="iu iv iw ao dx ap hi ix iy l">Make Medium yours</h4></a></div><span class="ao b ap aq ar as l iz ja">Follow all the topics you care about, and we’ll deliver the best stories for you to your homepage and inbox. <a href="https://medium.com/topics?source=post_page-----ea53cd43311d----------------------" class="cx cy ax ay az ba bb bc bd be bh bi is it jb" rel="noopener">Explore</a></span></div><div class="in l io"><div class="ip l"><a href="https://medium.com/membership?source=post_page-----ea53cd43311d----------------------" class="cx cy ax ay az ba bb bc bd be iq ir bh bi is it" rel="noopener"><h4 class="iu iv iw ao dx ap hi ix iy l">Become a member</h4></a></div><span class="ao b ap aq ar as l iz ja">Get unlimited access to the best stories on Medium — and support writers while you’re at it. Just $5/month. <a href="https://medium.com/membership?source=post_page-----ea53cd43311d----------------------" class="cx cy ax ay az ba bb bc bd be bh bi is it jb" rel="noopener">Upgrade</a></span></div></div></div><div class="af ag fq"><a href="https://medium.com/?source=post_page-----ea53cd43311d----------------------" class="cx cy ax ay az ba bb bc bd be iq ir bh bi is it" rel="noopener"><svg height="22" width="112" viewBox="0 0 111.5 22" class="iv"><path d="M56.3 19.5c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5V19c-.7 1.8-2.4 3-4.3 3-3.3 0-5.8-2.6-5.8-7.5 0-4.5 2.6-7.6 6.3-7.6 1.6-.1 3.1.8 3.8 2.4V3.2c0-.3-.1-.6-.3-.7l-1.4-1.4V1l6.5-.8v19.3zm-4.8-.8V9.5c-.5-.6-1.2-.9-1.9-.9-1.6 0-3.1 1.4-3.1 5.7 0 4 1.3 5.4 3 5.4.8.1 1.6-.3 2-1zm9.1 3.1V9.4c0-.3-.1-.6-.3-.7l-1.4-1.5v-.1h6.5v12.5c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5zm-.2-19.2C60.4 1.2 61.5 0 63 0c1.4 0 2.6 1.2 2.6 2.6S64.4 5.3 63 5.3a2.6 2.6 0 0 1-2.6-2.7zm22.5 16.9c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5v-3.2c-.6 2-2.4 3.4-4.5 3.4-2.9 0-4.4-2.1-4.4-6.2 0-1.9 0-4.1.1-6.5 0-.3-.1-.5-.3-.7L67.7 7v.1H74v8c0 2.6.4 4.4 2 4.4.9-.1 1.7-.6 2.1-1.3V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v12.4zm22 2.3c0-.5.1-6.5.1-7.9 0-2.6-.4-4.5-2.2-4.5-.9 0-1.8.5-2.3 1.3.2.8.3 1.7.3 2.5 0 1.8-.1 4.2-.1 6.5 0 .3.1.5.3.7l1.5 1.4v.1H96c0-.4.1-6.5.1-7.9 0-2.7-.4-4.5-2.2-4.5-.9 0-1.7.5-2.2 1.3v9c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v3.1a4.6 4.6 0 0 1 4.6-3.4c2.2 0 3.6 1.2 4.2 3.5.7-2.1 2.7-3.6 4.9-3.5 2.9 0 4.5 2.2 4.5 6.2 0 1.9-.1 4.2-.1 6.5-.1.3.1.6.3.7l1.4 1.4v.1h-6.6zm-81.4-2l1.9 1.9v.1h-9.8v-.1l2-1.9c.2-.2.3-.4.3-.7V7.3c0-.5 0-1.2.1-1.8L11.4 22h-.1L4.5 6.8c-.1-.4-.2-.4-.3-.6v10c-.1.7 0 1.3.3 1.9l2.7 3.6v.1H0v-.1L2.7 18c.3-.6.4-1.3.3-1.9v-11c0-.5-.1-1.1-.5-1.5L.7 1.1V1h7l5.8 12.9L18.6 1h6.8v.1l-1.9 2.2c-.2.2-.3.5-.3.7v15.2c0 .2.1.5.3.6zm7.6-5.9c0 3.8 1.9 5.3 4.2 5.3 1.9.1 3.6-1 4.4-2.7h.1c-.8 3.7-3.1 5.5-6.5 5.5-3.7 0-7.2-2.2-7.2-7.4 0-5.5 3.5-7.6 7.3-7.6 3.1 0 6.4 1.5 6.4 6.2v.8h-8.7zm0-.8h4.3v-.8c0-3.9-.8-4.9-2-4.9-1.4.1-2.3 1.6-2.3 5.7z"></path></svg></a><span class="ao b ap aq ar as l iz ja"><div class="jd je af fq jf ai"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----ea53cd43311d----------------------" class="cx cy ax ay az ba bb bc bd be jg bh bi is it" rel="noopener">About</a><a href="https://help.medium.com/?source=post_page-----ea53cd43311d----------------------" class="cx cy ax ay az ba bb bc bd be jg bh bi is it" rel="noopener">Help</a><a href="https://medium.com/policy/9db0094a1e0f?source=post_page-----ea53cd43311d----------------------" class="cx cy ax ay az ba bb bc bd be jg bh bi is it" rel="noopener">Legal</a></div></span></div></section></div></div></div><script>window.__BUILD_ID__ = "development"</script><script>window.__GRAPHQL_URI__ = "https://itnext.io/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"config":{"nodeEnv":"production","version":"master-20190923-220049-bb0e37084d","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","iTunesAppId":"828256236","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","lightStep":{"name":"lite-web","host":"collector-medium.lightstep.com","token":"ce5be895bef60919541332990ac9fef2","appVersion":"master-20190923-220049-bb0e37084d"},"algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","sentry":{"dsn":"https:\u002F\u002F589e367c28ca47b195ce200d1507d18b@sentry.io\u002F1423575","environment":"production"},"isAmp":false,"googleAnalyticsCode":"UA-24232453-2","signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumOwnedAndOperatedCollectionIds":["544c7006046e","bcc38c8f6edf","444d13b52878","8d6b8a439e32","92d2092dc598","1285ba81cada","cb8577c9149e","8ccfed20cbb2","ae2a65f35510","3f6ecf56618","7b6769f2748b"]},"debug":{"requestId":"f3284630-da8a-4cf2-8192-43c094afce52","originalSpanCarrier":{"ot-tracer-spanid":"6f851e630065ce20","ot-tracer-traceid":"486ceabc2e4c5b8e","ot-tracer-sampled":"true"}},"session":{"user":{"id":"lo_Vm2SR0UOgcQB"},"xsrf":""},"stats":{"itemCount":0,"sending":false,"timeout":null,"backup":{}},"navigation":{"showBranchBanner":null,"hideGoogleOneTap":false,"branchData":{"loaded":false},"showNewPostStatsPage":false,"currentLocation":"https:\u002F\u002Fitnext.io\u002Fhow-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d","host":"itnext.io","hostname":"itnext.io","currentHash":""},"client":{"isBot":false,"isDnt":false,"isEu":false,"isNativeMedium":false,"isCustomDomain":true},"multiVote":{"clapsPerPost":{}},"metadata":{"faviconImageId":null}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY.variantFlags.0":{"name":"allow_access","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.0.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.0.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.1":{"name":"allow_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.1.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.1.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.2":{"name":"allow_test_auth","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.2.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.2.valueType":{"__typename":"VariantFlagString","value":"disallow"},"ROOT_QUERY.variantFlags.3":{"name":"available_annual_plan","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.3.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.3.valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"},"ROOT_QUERY.variantFlags.4":{"name":"available_monthly_plan","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.4.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.4.valueType":{"__typename":"VariantFlagString","value":"60e220181034"},"ROOT_QUERY.variantFlags.5":{"name":"browsable_stream_config_bucket","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.5.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.5.valueType":{"__typename":"VariantFlagString","value":"curated-topics"},"ROOT_QUERY.variantFlags.6":{"name":"disable_gosocial_followers_that_you_follow","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.6.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.6.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.7":{"name":"disable_ios_resume_reading_toast","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.7.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.7.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.8":{"name":"disable_mobile_featured_chunk","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.8.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.8.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.9":{"name":"enable_annual_renewal_reminder_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.9.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.9.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.10":{"name":"enable_automated_mission_control_triggers","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.10.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.10.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.11":{"name":"enable_branch_io","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.11.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.11.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.12":{"name":"enable_branding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.12.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.12.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.13":{"name":"enable_branding_fonts","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.13.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.13.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.14":{"name":"enable_daily_read_digest_promo","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.14.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.14.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.15":{"name":"enable_dedicated_series_tab_api_ios","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.15.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.15.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.16":{"name":"enable_disregard_trunc_state_for_footer","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.16.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.16.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.17":{"name":"enable_edit_alt_text","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.17.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.17.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.18":{"name":"enable_embedding_based_diversification","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.18.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.18.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.19":{"name":"enable_google_one_tap","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.19.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.19.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.20":{"name":"enable_inline_search_lite","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.20.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.20.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.21":{"name":"enable_inline_search_popover_lite","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.21.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.21.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.22":{"name":"enable_ios_post_stats","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.22.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.22.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.23":{"name":"enable_janky_spam_rules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.23.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.23.valueType":{"__typename":"VariantFlagString","value":"users,posts"},"ROOT_QUERY.variantFlags.24":{"name":"enable_kafka_events","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.24.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.24.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.25":{"name":"enable_limit_diversification_heuristic","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.25.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.25.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.26":{"name":"enable_lite_image_zoom","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.26.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.26.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.27":{"name":"enable_lite_notifications","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.27.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.27.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.28":{"name":"enable_lite_post","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.28.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.28.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.29":{"name":"enable_lite_post_cd","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.29.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.29.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.30":{"name":"enable_lite_post_highlights","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.30.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.30.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.31":{"name":"enable_lite_post_highlights_view_only","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.31.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.31.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.32":{"name":"enable_lite_profile","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.32.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.32.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.33":{"name":"enable_lite_pub_header_menu","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.33.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.33.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.34":{"name":"enable_lite_read_next","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.34.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.34.valueType":{"__typename":"VariantFlagString","value":"topbar"},"ROOT_QUERY.variantFlags.35":{"name":"enable_lite_stories","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.35.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.35.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.36":{"name":"enable_lite_topics","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.36.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.36.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.37":{"name":"enable_lite_twitter_text_shots","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.37.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.37.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.38":{"name":"enable_lite_unread_notification_count_mutation","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.38.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.38.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.39":{"name":"enable_live_user_post_scoring","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.39.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.39.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.40":{"name":"enable_logged_out_homepage_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.40.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.40.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.41":{"name":"enable_marketing_emails","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.41.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.41.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.42":{"name":"enable_media_resource_try_catch","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.42.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.42.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.43":{"name":"enable_more_branch_data","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.43.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.43.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.44":{"name":"enable_new_collaborative_filtering_data","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.44.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.44.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.45":{"name":"enable_optimizely","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.45.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.45.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.46":{"name":"enable_parsely","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.46.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.46.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.47":{"name":"enable_patronus_on_kubernetes","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.47.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.47.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.48":{"name":"enable_popular_provider","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.48.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.48.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.49":{"name":"enable_post_import","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.49.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.49.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.50":{"name":"enable_primary_topic_for_mobile","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.50.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.50.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.51":{"name":"enable_quarantine_rules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.51.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.51.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.52":{"name":"enable_rank_service_newsletters","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.52.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.52.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.53":{"name":"enable_save_to_medium","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.53.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.53.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.54":{"name":"enable_serve_recs_from_ml_rank_app_highlights","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.54.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.54.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.55":{"name":"enable_serve_recs_from_ml_rank_digest","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.55.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.55.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.56":{"name":"enable_serve_recs_from_ml_rank_homepage","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.56.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.56.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.57":{"name":"enable_tick_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.57.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.57.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.58":{"name":"enable_ticks_digest_promo","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.58.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.58.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.59":{"name":"enable_tipalti_onboarding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.59.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.59.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.60":{"name":"enable_topic_lifecycle_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.60.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.60.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.61":{"name":"enable_trumpland_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.61.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.61.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.62":{"name":"glyph_font_set","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.62.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.62.valueType":{"__typename":"VariantFlagString","value":"m2"},"ROOT_QUERY.variantFlags.63":{"name":"google_sign_in_android","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.63.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.63.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.64":{"name":"is_not_medium_subscriber","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.64.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.64.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.65":{"name":"new_transition_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.65.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.65.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.66":{"name":"pub_sidebar","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.66.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.66.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.67":{"name":"rank_model","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.67.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.67.valueType":{"__typename":"VariantFlagString","value":"default"},"ROOT_QUERY.variantFlags.68":{"name":"redis_read_write_splitting","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.68.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.68.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.69":{"name":"signin_services","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.69.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.69.valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap"},"ROOT_QUERY.variantFlags.70":{"name":"signup_services","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.70.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.70.valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap"},"ROOT_QUERY.variantFlags.71":{"name":"use_new_admin_topic_backend","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.71.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.71.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY":{"variantFlags":[{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.0","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.1","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.2","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.3","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.4","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.5","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.6","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.7","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.8","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.9","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.10","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.11","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.12","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.13","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.14","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.15","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.16","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.17","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.18","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.19","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.20","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.21","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.22","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.23","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.24","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.25","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.26","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.27","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.28","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.29","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.30","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.31","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.32","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.33","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.34","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.35","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.36","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.37","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.38","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.39","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.40","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.41","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.42","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.43","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.44","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.45","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.46","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.47","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.48","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.49","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.50","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.51","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.52","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.53","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.54","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.55","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.56","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.57","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.58","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.59","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.60","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.61","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.62","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.63","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.64","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.65","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.66","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.67","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.68","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.69","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.70","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.71","typename":"VariantFlag"}],"viewer":null,"meterPost({\"postId\":\"ea53cd43311d\",\"postMeteringOptions\":{}})":{"type":"id","generated":false,"id":"MeteringInfo:singleton","typename":"MeteringInfo"},"postResult({\"id\":\"ea53cd43311d\"})":{"type":"id","generated":false,"id":"Post:ea53cd43311d","typename":"Post"}},"MeteringInfo:singleton":{"__typename":"MeteringInfo","postIds":{"type":"json","json":["ea53cd43311d"]},"maxUnlockCount":3,"unlocksRemaining":2},"Post:ea53cd43311d":{"__typename":"Post","visibility":"LOCKED","latestPublishedVersion":"e8c759bcc8f4","collection":{"type":"id","generated":false,"id":"Collection:5b301f10ddcd","typename":"Collection"},"id":"ea53cd43311d","creator":{"type":"id","generated":false,"id":"User:10bdd399e06b","typename":"User"},"isLocked":true,"lockedSource":"LOCKED_POST_SOURCE_UGC_UNENROLLED","sequence":null,"mediumUrl":"https:\u002F\u002Fitnext.io\u002Fhow-to-create-a-simple-etl-job-locally-with-pyspark-postgresql-and-docker-ea53cd43311d","canonicalUrl":"","content({\"postMeteringOptions\":{}})":{"type":"id","generated":true,"id":"$Post:ea53cd43311d.content({\"postMeteringOptions\":{}})","typename":"PostContent"},"firstPublishedAt":1567769765691,"isPublished":true,"layerCake":3,"primaryTopic":{"type":"id","generated":false,"id":"data-science","typename":"Topic"},"title":"How to create a simple ETL Job locally with PySpark, PostgreSQL and Docker","isLimitedState":false,"pendingCollection":null,"shareKey":null,"statusForCollection":"APPROVED","readingTime":5.59433962264151,"license":"ALL_RIGHTS_RESERVED","allowResponses":true,"tags":[{"type":"id","generated":false,"id":"Tag:big-data","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:python","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:pyspark","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:postgresql","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:docker","typename":"Tag"}],"viewerClapCount":0,"readingList":"READING_LIST_NONE","clapCount":371,"voterCount":54,"recommenders":[],"responsesCount":0,"collaborators":[{"type":"id","generated":false,"id":"Collaborator:ea53cd43311d-a00b22a457b","typename":"Collaborator"},{"type":"id","generated":false,"id":"Collaborator:ea53cd43311d-cb3f1b710e82","typename":"Collaborator"}],"translationSourcePost":null,"inResponseToPostResult":null,"inResponseToMediaResource":null,"curationEligibleAt":1567769729184,"audioVersionUrl":null,"socialTitle":"","socialDek":"","metaDescription":"","latestPublishedAt":1567770070612,"previewContent":{"type":"id","generated":true,"id":"$Post:ea53cd43311d.previewContent","typename":"PreviewContent"},"previewImage":{"type":"id","generated":false,"id":"ImageMetadata:1*fTDEt8iL5ck37gWHsJ6_-w.png","typename":"ImageMetadata"},"updatedAt":1567776224275,"topics":[{"type":"id","generated":false,"id":"data-science","typename":"Topic"},{"type":"id","generated":false,"id":"programming","typename":"Topic"}],"isSuspended":false},"Collection:5b301f10ddcd":{"id":"5b301f10ddcd","domain":"itnext.io","slug":"itnext","__typename":"Collection","googleAnalyticsId":"UA-29035124-5","colorBehavior":"ACCENT_COLOR_AND_FILL_BACKGROUND","name":"ITNEXT","logo":{"type":"id","generated":false,"id":"ImageMetadata:1*brBJMIxU4BNVrxYigrVEkQ.png","typename":"ImageMetadata"},"avatar":{"type":"id","generated":false,"id":"ImageMetadata:1*yAqDFIFA5F_NXalOJKz4TA.png","typename":"ImageMetadata"},"isEnrolledInHightower":false,"creator":{"type":"id","generated":false,"id":"User:5db23d2304f9","typename":"User"},"viewerIsEditor":false,"navItems":[{"type":"id","generated":true,"id":"Collection:5b301f10ddcd.navItems.0","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:5b301f10ddcd.navItems.1","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:5b301f10ddcd.navItems.2","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:5b301f10ddcd.navItems.3","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:5b301f10ddcd.navItems.4","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:5b301f10ddcd.navItems.5","typename":"NavItem"}],"colorPalette":{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette","typename":"ColorPalette"},"viewerCanEditOwnPosts":false,"viewerCanEditPosts":false,"description":"ITNEXT is a platform for IT developers & software engineers to share knowledge, connect, collaborate, learn and experience next-gen technologies.","viewerIsFollowing":false,"viewerIsSubscribedToLetters":false,"isUserSubscribedToCollectionEmails":false,"ampEnabled":false,"twitterUsername":"itnext_io","facebookPageId":null,"favicon":{"type":"id","generated":false,"id":"ImageMetadata:1*yAqDFIFA5F_NXalOJKz4TA.png","typename":"ImageMetadata"}},"User:10bdd399e06b":{"id":"10bdd399e06b","__typename":"User","isSuspended":false,"allowNotes":true,"name":"Anis Boudih","isFollowing":false,"username":"anisboudih","bio":"Junior Data Engineer @LINKIT | passionate about Big Data and Machine Learning","imageId":"2*VJ6P-VonuBBjg7Rmam2edA.jpeg","mediumMemberAt":0,"isBlocking":false,"isPartnerProgramEnrolled":false,"twitterScreenName":""},"ImageMetadata:1*brBJMIxU4BNVrxYigrVEkQ.png":{"id":"1*brBJMIxU4BNVrxYigrVEkQ.png","originalWidth":3159,"originalHeight":600,"__typename":"ImageMetadata"},"ImageMetadata:1*yAqDFIFA5F_NXalOJKz4TA.png":{"id":"1*yAqDFIFA5F_NXalOJKz4TA.png","__typename":"ImageMetadata"},"User:5db23d2304f9":{"id":"5db23d2304f9","__typename":"User"},"Collection:5b301f10ddcd.navItems.0":{"title":"About ITNEXT","url":"https:\u002F\u002Fitnext.io\u002Fabout-itnext-877f4197e8f6","type":"POST_NAV_ITEM","__typename":"NavItem"},"Collection:5b301f10ddcd.navItems.1":{"title":"Write for ITNEXT","url":"https:\u002F\u002Fitnext.io\u002Fwrite-for-itnext-4dea1fd3adf","type":"POST_NAV_ITEM","__typename":"NavItem"},"Collection:5b301f10ddcd.navItems.2":{"title":"Meetups","url":"https:\u002F\u002Fitnext.io\u002Fitnext-meetups-c28cd668e0bc","type":"POST_NAV_ITEM","__typename":"NavItem"},"Collection:5b301f10ddcd.navItems.3":{"title":"SUMMIT","url":"https:\u002F\u002Fitnext.io\u002Fitnextsummit-c21f4fabae34","type":"POST_NAV_ITEM","__typename":"NavItem"},"Collection:5b301f10ddcd.navItems.4":{"title":"Featured ","url":"https:\u002F\u002Fitnext.io\u002Fitnext-io-featuredthisweek\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:5b301f10ddcd.navItems.5":{"title":"Vacancies @ LINKIT","url":"https:\u002F\u002Fcareers.linkit.nl","type":"EXTERNAL_LINK_NAV_ITEM","__typename":"NavItem"},"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum":{"backgroundColor":"#FF1A71B1","colorPoints":[{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum.colorPoints.0","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum.colorPoints.1","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum.colorPoints.2","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum.colorPoints.3","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum.colorPoints.4","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum.colorPoints.5","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum.colorPoints.6","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum.colorPoints.7","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum.colorPoints.8","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum.colorPoints.9","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum.colorPoints.10","typename":"ColorPoint"}],"__typename":"ColorSpectrum"},"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum.colorPoints.0":{"color":"#FF1A71B1","point":0,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum.colorPoints.1":{"color":"#FF3E82BC","point":0.1,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum.colorPoints.2":{"color":"#FF5892C7","point":0.2,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum.colorPoints.3":{"color":"#FF6EA1D1","point":0.3,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum.colorPoints.4":{"color":"#FF84B0DB","point":0.4,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum.colorPoints.5":{"color":"#FF98BEE4","point":0.5,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum.colorPoints.6":{"color":"#FFACCCED","point":0.6,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum.colorPoints.7":{"color":"#FFBFDAF6","point":0.7,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum.colorPoints.8":{"color":"#FFD1E7FE","point":0.8,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum.colorPoints.9":{"color":"#FFE4F4FF","point":0.9,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum.colorPoints.10":{"color":"#FFF6FFFF","point":1,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette":{"tintBackgroundSpectrum":{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.tintBackgroundSpectrum","typename":"ColorSpectrum"},"__typename":"ColorPalette","defaultBackgroundSpectrum":{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum","typename":"ColorSpectrum"},"highlightSpectrum":{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum","typename":"ColorSpectrum"}},"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum":{"backgroundColor":"#FFFFFFFF","colorPoints":[{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum.colorPoints.0","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum.colorPoints.1","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum.colorPoints.2","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum.colorPoints.3","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum.colorPoints.4","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum.colorPoints.5","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum.colorPoints.6","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum.colorPoints.7","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum.colorPoints.8","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum.colorPoints.9","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum.colorPoints.10","typename":"ColorPoint"}],"__typename":"ColorSpectrum"},"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum.colorPoints.0":{"color":"#FF3F8DCE","point":0,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum.colorPoints.1":{"color":"#FF3F83BD","point":0.1,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum.colorPoints.2":{"color":"#FF3D79AD","point":0.2,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum.colorPoints.3":{"color":"#FF3B6E9C","point":0.3,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum.colorPoints.4":{"color":"#FF38648B","point":0.4,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum.colorPoints.5":{"color":"#FF34597A","point":0.5,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum.colorPoints.6":{"color":"#FF2F4E6A","point":0.6,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum.colorPoints.7":{"color":"#FF2A4259","point":0.7,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum.colorPoints.8":{"color":"#FF233648","point":0.8,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum.colorPoints.9":{"color":"#FF1B2937","point":0.9,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.defaultBackgroundSpectrum.colorPoints.10":{"color":"#FF121B25","point":1,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum":{"backgroundColor":"#FFFFFFFF","colorPoints":[{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum.colorPoints.0","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum.colorPoints.1","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum.colorPoints.2","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum.colorPoints.3","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum.colorPoints.4","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum.colorPoints.5","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum.colorPoints.6","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum.colorPoints.7","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum.colorPoints.8","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum.colorPoints.9","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum.colorPoints.10","typename":"ColorPoint"}],"__typename":"ColorSpectrum"},"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum.colorPoints.0":{"color":"#FFE6F5FF","point":0,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum.colorPoints.1":{"color":"#FFE2F4FF","point":0.1,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum.colorPoints.2":{"color":"#FFDDF2FF","point":0.2,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum.colorPoints.3":{"color":"#FFD8F1FF","point":0.3,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum.colorPoints.4":{"color":"#FFD3F0FF","point":0.4,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum.colorPoints.5":{"color":"#FFCDEFFF","point":0.5,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum.colorPoints.6":{"color":"#FFC8EDFF","point":0.6,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum.colorPoints.7":{"color":"#FFC3ECFF","point":0.7,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum.colorPoints.8":{"color":"#FFBDEBFF","point":0.8,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum.colorPoints.9":{"color":"#FFB7E9FF","point":0.9,"__typename":"ColorPoint"},"$Collection:5b301f10ddcd.colorPalette.highlightSpectrum.colorPoints.10":{"color":"#FFB1E8FF","point":1,"__typename":"ColorPoint"},"$Post:ea53cd43311d.content({\"postMeteringOptions\":{}})":{"isLockedPreviewOnly":false,"validatedShareKey":"","__typename":"PostContent","bodyModel":{"type":"id","generated":true,"id":"$Post:ea53cd43311d.content({\"postMeteringOptions\":{}}).bodyModel","typename":"RichText"}},"data-science":{"name":"Data Science","slug":"data-science","__typename":"Topic","isFollowing":null},"$Post:ea53cd43311d.content({\"postMeteringOptions\":{}}).bodyModel.sections.0":{"name":"2991","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:ea53cd43311d.content({\"postMeteringOptions\":{}}).bodyModel":{"sections":[{"type":"id","generated":true,"id":"$Post:ea53cd43311d.content({\"postMeteringOptions\":{}}).bodyModel.sections.0","typename":"Section"}],"paragraphs":[{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_0","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_1","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_2","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_3","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_4","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_5","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_6","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_7","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_8","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_9","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_10","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_11","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_12","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_13","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_14","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_15","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_16","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_17","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_18","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_19","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_20","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_21","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_22","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_23","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_24","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_25","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_26","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_27","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_28","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_29","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_30","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_31","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_32","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_33","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_34","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_35","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_36","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_37","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_38","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_39","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_40","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_41","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_42","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_43","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_44","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_45","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_46","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_47","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_48","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_49","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_50","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_51","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_52","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_53","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_54","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_55","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:e8c759bcc8f4_56","typename":"Paragraph"}],"__typename":"RichText"},"Paragraph:e8c759bcc8f4_0":{"id":"e8c759bcc8f4_0","name":"c7b5","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"How to create a simple ETL Job locally with PySpark, PostgreSQL and Docker","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_0.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_0.markups.0":{"type":"STRONG","start":0,"end":74,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_1":{"id":"e8c759bcc8f4_1","name":"20be","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*fTDEt8iL5ck37gWHsJ6_-w.png","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*fTDEt8iL5ck37gWHsJ6_-w.png":{"id":"1*fTDEt8iL5ck37gWHsJ6_-w.png","originalHeight":374,"originalWidth":2048,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:e8c759bcc8f4_2":{"id":"e8c759bcc8f4_2","name":"462c","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Introduction","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_2.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_2.markups.0":{"type":"STRONG","start":0,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_3":{"id":"e8c759bcc8f4_3","name":"a05b","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"In this article, I’m going to demonstrate how Apache Spark can be utilised for writing powerful ETL jobs in Python. If you’re already familiar with Python and working with data from day to day, then PySpark is going to help you to create more scalable processing and analysis of (big) data.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_4":{"id":"e8c759bcc8f4_4","name":"a06b","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The data that I’ll use is scraped from Ebay-Kleinanzeigen, which is the German branch of Ebay where people can advertise their properties. In our case, we will work with a dataset that contains information from over 370000 used cars; besides, it’s important to note that the content of the data is in German.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_5":{"id":"e8c759bcc8f4_5","name":"187f","__typename":"Paragraph","type":"BQ","href":null,"layout":null,"metadata":null,"text":"link to data hosted on Kaggle","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_5.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_5.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_5.markups.0":{"type":"A","start":0,"end":29,"href":"https:\u002F\u002Fwww.kaggle.com\u002Forgesleka\u002Fused-cars-database","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_5.markups.1":{"type":"EM","start":0,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_6":{"id":"e8c759bcc8f4_6","name":"21ad","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"What is Apache Spark","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_6.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_6.markups.0":{"type":"STRONG","start":0,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_7":{"id":"e8c759bcc8f4_7","name":"4260","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Apache Spark is one of the most popular engines for large-scale data processing. It’s an open source system with an API supporting multiple programming languages. Processing of data is done in memory, hence it’s several times faster than for example MapReduce. Spark comes with libraries supporting a wide range of tasks, such as streaming, machine learning and SQL. It’s able to run from your local computer, but also can be scaled up to a cluster of hundreds of servers.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_7.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_7.markups.0":{"type":"STRONG","start":0,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_8":{"id":"e8c759bcc8f4_8","name":"1c3a","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"What is ETL?","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_8.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_8.markups.0":{"type":"STRONG","start":0,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_9":{"id":"e8c759bcc8f4_9","name":"5262","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"ETL (Extract, Transform and Load) is the procedure of migrating data from one system to another. Data extraction is the process of retrieving data out of homogeneous or heterogeneous sources for further data processing and data storage. During data processing, the data is being cleaned and incorrect or inaccurate records are being modified or deleted. Finally, the processed data is loaded (e.g. stored) into a target database such as a data warehouse or data lake.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_9.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_9.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_9.markups.2","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_9.markups.0":{"type":"STRONG","start":5,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_9.markups.1":{"type":"STRONG","start":14,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_9.markups.2":{"type":"STRONG","start":28,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_10":{"id":"e8c759bcc8f4_10","name":"2849","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Extract","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_10.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_10.markups.0":{"type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_11":{"id":"e8c759bcc8f4_11","name":"1e9e","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The starting point of every Spark application is the creation of a SparkSession. This is a driver process that maintains all relevant information about your Spark Application and it is also responsible for distributing and scheduling your application across all executors. We can simply create a SparkSession in the following way:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_12":{"id":"e8c759bcc8f4_12","name":"fdb9","__typename":"Paragraph","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":{"type":"id","generated":true,"id":"$Paragraph:e8c759bcc8f4_12.iframe","typename":"Iframe"},"mixtapeMetadata":null},"MediaResource:94b2413121f8e20e4d8ed7d8229e370b":{"id":"94b2413121f8e20e4d8ed7d8229e370b","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"initialize spark","__typename":"MediaResource"},"$Paragraph:e8c759bcc8f4_12.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:94b2413121f8e20e4d8ed7d8229e370b","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:e8c759bcc8f4_13":{"id":"e8c759bcc8f4_13","name":"9264","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The getOrCreate method will try to get a SparkSession if one is already created, otherwise it will create a new one. With the master option it is possible to specify the master URL that is being connected. However, because we’re running our job locally, we will specify the local[*] argument. This means that Spark will use as many worker threads as logical cores on your machine. We set the application name with the appName option, this name will appear in the Spark UI and log data.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_13.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_13.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_13.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_13.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_13.markups.4","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_13.markups.0":{"type":"CODE","start":4,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_13.markups.1":{"type":"CODE","start":126,"end":132,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_13.markups.2":{"type":"CODE","start":274,"end":282,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_13.markups.3":{"type":"CODE","start":418,"end":425,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_13.markups.4":{"type":"EM","start":274,"end":282,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_14":{"id":"e8c759bcc8f4_14","name":"3db2","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Our next step is to read the CSV file. Reading in a CSV can be done with a DataFrameReader that is associated with our SparkSession. In doing so, Spark allows us to specify whether schema inference is being used as well as some other options:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_14.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_14.markups.0":{"type":"CODE","start":75,"end":90,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_15":{"id":"e8c759bcc8f4_15","name":"51e7","__typename":"Paragraph","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":{"type":"id","generated":true,"id":"$Paragraph:e8c759bcc8f4_15.iframe","typename":"Iframe"},"mixtapeMetadata":null},"MediaResource:84ba489d68a95f930f7fa80ded462a33":{"id":"84ba489d68a95f930f7fa80ded462a33","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"load_without_schema.py","__typename":"MediaResource"},"$Paragraph:e8c759bcc8f4_15.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:84ba489d68a95f930f7fa80ded462a33","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:e8c759bcc8f4_16":{"id":"e8c759bcc8f4_16","name":"ca49","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Whether to choose for schema inference or manually defining a schema depends heavily on the use case, in case of writing an ETL job for a production environment, it is strongly recommended to define a schema in order to prevent inaccurate data representation. Another constraint of schema inference is that it tends to make your Spark application slower, especially when working with CSV or JSON. Therefore, I’m also showing how to read in data with a prior defined schema:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_17":{"id":"e8c759bcc8f4_17","name":"8fc7","__typename":"Paragraph","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":{"type":"id","generated":true,"id":"$Paragraph:e8c759bcc8f4_17.iframe","typename":"Iframe"},"mixtapeMetadata":null},"MediaResource:41b9dcf15f69aaa7ffe1107c669699d4":{"id":"41b9dcf15f69aaa7ffe1107c669699d4","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"load_with_schema.py","__typename":"MediaResource"},"$Paragraph:e8c759bcc8f4_17.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:41b9dcf15f69aaa7ffe1107c669699d4","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:e8c759bcc8f4_18":{"id":"e8c759bcc8f4_18","name":"d191","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Transform","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_18.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_18.markups.0":{"type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_19":{"id":"e8c759bcc8f4_19","name":"5af8","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"We’re now ready to have a closer look at our data and start to do more interesting stuff:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_20":{"id":"e8c759bcc8f4_20","name":"fad4","__typename":"Paragraph","type":"IMG","href":null,"layout":"FULL_WIDTH","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*Le-yFQWGfMr-r9Wmt7ntVQ.png","typename":"ImageMetadata"},"text":"First five rows of the car dataset","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Le-yFQWGfMr-r9Wmt7ntVQ.png":{"id":"1*Le-yFQWGfMr-r9Wmt7ntVQ.png","originalHeight":186,"originalWidth":2504,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:e8c759bcc8f4_21":{"id":"e8c759bcc8f4_21","name":"70fc","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see, there are multiple columns containing null values. We can handle missing data with a wide variety of options. However, discussing this is out of the scope of this article. As a result, we choose to leave the missing values as null. However, there are more strange values and columns in this dataset, so some basic transformations are needed:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_21.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_21.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_21.markups.0":{"type":"CODE","start":54,"end":58,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_21.markups.1":{"type":"CODE","start":242,"end":246,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_22":{"id":"e8c759bcc8f4_22","name":"9cfe","__typename":"Paragraph","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":{"type":"id","generated":true,"id":"$Paragraph:e8c759bcc8f4_22.iframe","typename":"Iframe"},"mixtapeMetadata":null},"MediaResource:26daba5574c153cdedfa98f5035de31f":{"id":"26daba5574c153cdedfa98f5035de31f","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"clean_drop_data.py","__typename":"MediaResource"},"$Paragraph:e8c759bcc8f4_22.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:26daba5574c153cdedfa98f5035de31f","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:e8c759bcc8f4_23":{"id":"e8c759bcc8f4_23","name":"5d3d","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The rationale for this cleaning is based on the following: the columns dateCrawled and lastSeen doesn’t seem to be useful for any future analysis. All the values in the column nrOfPictures were equal to 0, hence we decided to drop this column.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_23.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_23.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_23.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_23.markups.3","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_23.markups.0":{"type":"CODE","start":71,"end":82,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_23.markups.1":{"type":"CODE","start":87,"end":95,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_23.markups.2":{"type":"CODE","start":176,"end":188,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_23.markups.3":{"type":"CODE","start":203,"end":204,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_24":{"id":"e8c759bcc8f4_24","name":"347a","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"seller\ngewerblich         3\nprivat        371525","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_24.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_24.markups.0":{"type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_25":{"id":"e8c759bcc8f4_25","name":"7989","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"offerType\nAngebot    371513\nGesuch         12","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_25.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_25.markups.0":{"type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_26":{"id":"e8c759bcc8f4_26","name":"b78d","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Inspecting the columns seller and offerType resulted in the following numbers. As a result, we can remove the three rows containing “gewerblich” and then drop the column seller. The same logic applies also for the column offerType, consequently we’re left with a more balanced dataset. For the sake of example, we leave the dataset like this:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_26.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_26.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_26.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_26.markups.3","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_26.markups.0":{"type":"CODE","start":23,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_26.markups.1":{"type":"CODE","start":34,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_26.markups.2":{"type":"CODE","start":170,"end":176,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_26.markups.3":{"type":"CODE","start":221,"end":230,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_27":{"id":"e8c759bcc8f4_27","name":"1821","__typename":"Paragraph","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*4PT02sDjdzEDFNetV-PcOw.png","typename":"ImageMetadata"},"text":"First five rows of the ‘cleaned’ car dataset","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*4PT02sDjdzEDFNetV-PcOw.png":{"id":"1*4PT02sDjdzEDFNetV-PcOw.png","originalHeight":374,"originalWidth":2550,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:e8c759bcc8f4_28":{"id":"e8c759bcc8f4_28","name":"3c38","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Load","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_28.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_28.markups.0":{"type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_29":{"id":"e8c759bcc8f4_29","name":"14d5","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"We have translated our raw data into analysis-ready data, hence we’re ready to load our data into our locally running PostgreSQL database for further analysis in the nearby future. We have spun up a PostgreSQL database with pgAdmin with this basic docker-compose file. This docker-compose configuration file defines all containers in our current setup with their corresponding settings. For example, we initialised a PostgreSQL database with namecars, username admin and password admin.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_29.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_29.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_29.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_29.markups.3","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_29.markups.0":{"type":"CODE","start":446,"end":450,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_29.markups.1":{"type":"CODE","start":461,"end":466,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_29.markups.2":{"type":"CODE","start":480,"end":485,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_29.markups.3":{"type":"A","start":248,"end":267,"href":"https:\u002F\u002Fgithub.com\u002Fklimpie94\u002Fpyspark-etl-analytics\u002Fblob\u002Fmaster\u002Fdocker-compose.yml","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_30":{"id":"e8c759bcc8f4_30","name":"cdf1","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Psycopg2 is the most popular PostgreSQL database driver for Python. It provides a simple and concise way for interacting with a PostgreSQL instance. First, we establish a connection to thecars database:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_30.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_30.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_30.markups.0":{"type":"CODE","start":188,"end":192,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_30.markups.1":{"type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_31":{"id":"e8c759bcc8f4_31","name":"ad36","__typename":"Paragraph","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":{"type":"id","generated":true,"id":"$Paragraph:e8c759bcc8f4_31.iframe","typename":"Iframe"},"mixtapeMetadata":null},"MediaResource:e1f6e51688f0169627666b2ae34b9450":{"id":"e1f6e51688f0169627666b2ae34b9450","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"postgres_con.py","__typename":"MediaResource"},"$Paragraph:e8c759bcc8f4_31.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:e1f6e51688f0169627666b2ae34b9450","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:e8c759bcc8f4_32":{"id":"e8c759bcc8f4_32","name":"b262","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"In doing so, we have to provide some general parameters to the connect function. There is also a possibility to specify the port, however, in our case there is no need to specify the port, since we’re running the PostgreSQL instance on the default port 5432. So, we have our session started and we’re connected to Postgres. After having a connection, it’s possible to write our commands (e.g. inserts, updates) and Psycopg2 allows us to do this with cursors. A cursor is created out of a connection and it will allow you to communicate with PostgreSQL.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_32.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_32.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_32.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_32.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_32.markups.4","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_32.markups.0":{"type":"CODE","start":63,"end":70,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_32.markups.1":{"type":"CODE","start":124,"end":128,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_32.markups.2":{"type":"CODE","start":253,"end":257,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_32.markups.3":{"type":"CODE","start":450,"end":457,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_32.markups.4":{"type":"STRONG","start":415,"end":423,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_33":{"id":"e8c759bcc8f4_33","name":"462f","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# cursor\ncur = conn.cursor()","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_34":{"id":"e8c759bcc8f4_34","name":"58c2","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Now that we have created a cursor, we are able to create a table named cars_table in our cars database:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_34.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_34.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_34.markups.0":{"type":"CODE","start":71,"end":81,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_34.markups.1":{"type":"CODE","start":89,"end":93,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_35":{"id":"e8c759bcc8f4_35","name":"2b6d","__typename":"Paragraph","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":{"type":"id","generated":true,"id":"$Paragraph:e8c759bcc8f4_35.iframe","typename":"Iframe"},"mixtapeMetadata":null},"MediaResource:603a9ed3cc07b86f9bac52f9a5877bd9":{"id":"603a9ed3cc07b86f9bac52f9a5877bd9","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"create_table.py","__typename":"MediaResource"},"$Paragraph:e8c759bcc8f4_35.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:603a9ed3cc07b86f9bac52f9a5877bd9","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:e8c759bcc8f4_36":{"id":"e8c759bcc8f4_36","name":"f9f4","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"After creating the table, it’s now ready to be populated with our dataset. We can insert our data row by row, by providing our data as a list of tuples (where each record is one tuple) to our INSERT statement:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_36.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_36.markups.0":{"type":"CODE","start":192,"end":198,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_37":{"id":"e8c759bcc8f4_37","name":"1d7a","__typename":"Paragraph","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":{"type":"id","generated":true,"id":"$Paragraph:e8c759bcc8f4_37.iframe","typename":"Iframe"},"mixtapeMetadata":null},"MediaResource:cd7a34bf82340fc607657ce82ed9e09c":{"id":"cd7a34bf82340fc607657ce82ed9e09c","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"insert_postgres.py","__typename":"MediaResource"},"$Paragraph:e8c759bcc8f4_37.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:cd7a34bf82340fc607657ce82ed9e09c","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:e8c759bcc8f4_38":{"id":"e8c759bcc8f4_38","name":"f497","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"As a result, it is now possible to execute this command with our previously defined cursor:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_39":{"id":"e8c759bcc8f4_39","name":"5020","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"cur.execute(insert_query, cars_seq)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_40":{"id":"e8c759bcc8f4_40","name":"f777","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see, thanks to Psycopg2, it is really easy to transfer your data from your application to a backend database such as PostgreSQL. Lastly, we’re going to query our recently populated table with Psycopg2:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_40.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_40.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_40.markups.0":{"type":"STRONG","start":26,"end":34,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_40.markups.1":{"type":"STRONG","start":203,"end":211,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_41":{"id":"e8c759bcc8f4_41","name":"a96b","__typename":"Paragraph","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":{"type":"id","generated":true,"id":"$Paragraph:e8c759bcc8f4_41.iframe","typename":"Iframe"},"mixtapeMetadata":null},"MediaResource:7b2c4e54e758ce0c125068c61c2728ba":{"id":"7b2c4e54e758ce0c125068c61c2728ba","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"query_cars.py","__typename":"MediaResource"},"$Paragraph:e8c759bcc8f4_41.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:7b2c4e54e758ce0c125068c61c2728ba","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:e8c759bcc8f4_42":{"id":"e8c759bcc8f4_42","name":"e99e","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Which gives us the following output in our terminal:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_43":{"id":"e8c759bcc8f4_43","name":"5f84","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Printing 2 rows\nBrand =  volkswagen\nModel =  golf\nPrice  =  480","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_44":{"id":"e8c759bcc8f4_44","name":"eb4d","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Brand =  audi\nModel =  None\nPrice  =  18300","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_45":{"id":"e8c759bcc8f4_45","name":"ede6","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"However, we’re still missing one important piece of code: Psycopg is Python DB-API compliant, so the auto-commit feature is off by default. As a result, we need to call the following code to commit our transaction to PostgreSQL:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_45.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_45.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_45.markups.2","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_45.markups.0":{"type":"CODE","start":124,"end":127,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_45.markups.1":{"type":"STRONG","start":58,"end":66,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_45.markups.2":{"type":"EM","start":21,"end":42,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_46":{"id":"e8c759bcc8f4_46","name":"d1ac","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"conn.commit()","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_47":{"id":"e8c759bcc8f4_47","name":"7eb8","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"And to make sure, we can check in pgAdmin if the dataset is loaded correctly in PostgreSQL:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_48":{"id":"e8c759bcc8f4_48","name":"bacc","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*LbJJyFaLQsWzWdlX7ASDBA.png","typename":"ImageMetadata"},"text":"Cars dataset loaded in pgAdmin","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*LbJJyFaLQsWzWdlX7ASDBA.png":{"id":"1*LbJJyFaLQsWzWdlX7ASDBA.png","originalHeight":1506,"originalWidth":3358,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:e8c759bcc8f4_49":{"id":"e8c759bcc8f4_49","name":"73ee","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Final remarks","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_49.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_49.markups.0":{"type":"STRONG","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_50":{"id":"e8c759bcc8f4_50","name":"9cd2","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Pyspark is a powerful and useful (big) data tool for any Data Engineer or Data Scientist who is trying to build scalable data applications. I can definitely recommend everyone to have a serious look at it and try to incorporate it in one of your future projects. Thanks to Docker, we were able to spin up a local PostgreSQL database without installing anything! The code of this article can be found on Github. Please feel free to provide me with any feedback or comments, since this was my first article on a platform.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_50.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_50.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_50.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_50.markups.3","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_50.markups.0":{"type":"A","start":403,"end":409,"href":"https:\u002F\u002Fgithub.com\u002Fklimpie94\u002Fpyspark-etl-analytics","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_50.markups.1":{"type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_50.markups.2":{"type":"STRONG","start":273,"end":279,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_50.markups.3":{"type":"STRONG","start":313,"end":323,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_51":{"id":"e8c759bcc8f4_51","name":"df4a","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Also, feel free to contact me if you’re interested in attending a Data Engineering Bootcamp or if you’re just curious about how I experienced these two ‘intense’ months:)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_51.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_51.markups.0":{"type":"A","start":66,"end":91,"href":"https:\u002F\u002Fwww.linkit.nl\u002Fvacatures\u002Fdata-engineering\u002F0007529\u002Fdata-engineering-apprenticeship-starts-feb-1st-2020","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_52":{"id":"e8c759bcc8f4_52","name":"c859","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"References","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_52.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_52.markups.0":{"type":"STRONG","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_53":{"id":"e8c759bcc8f4_53","name":"6a19","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Official Apache Spark website","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_53.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_53.markups.0":{"type":"A","start":0,"end":29,"href":"https:\u002F\u002Fspark.apache.org\u002F","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_54":{"id":"e8c759bcc8f4_54","name":"f5eb","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"“Spark: The Definitive Guide by Bill Chambers and Matei Zaharia (O’Reilly). Copyright 2018 Databricks, Inc., 978–1–491–91221–8.”","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_55":{"id":"e8c759bcc8f4_55","name":"6228","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"What is ETL?","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_55.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_55.markups.0":{"type":"A","start":0,"end":12,"href":"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FExtract,_transform,_load","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:e8c759bcc8f4_56":{"id":"e8c759bcc8f4_56","name":"85a9","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Psycopg2 documentation","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:e8c759bcc8f4_56.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:e8c759bcc8f4_56.markups.0":{"type":"A","start":0,"end":22,"href":"http:\u002F\u002Finitd.org\u002Fpsycopg\u002Fdocs\u002F","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Tag:big-data":{"id":"big-data","displayTitle":"Big Data","__typename":"Tag"},"Tag:python":{"id":"python","displayTitle":"Python","__typename":"Tag"},"Tag:pyspark":{"id":"pyspark","displayTitle":"Pyspark","__typename":"Tag"},"Tag:postgresql":{"id":"postgresql","displayTitle":"Postgresql","__typename":"Tag"},"Tag:docker":{"id":"docker","displayTitle":"Docker","__typename":"Tag"},"Collaborator:ea53cd43311d-a00b22a457b":{"id":"ea53cd43311d-a00b22a457b","user":{"type":"id","generated":false,"id":"User:a00b22a457b","typename":"User"},"state":"visible","__typename":"Collaborator"},"User:a00b22a457b":{"id":"a00b22a457b","name":"Nils Nieuwenkamp","__typename":"User"},"Collaborator:ea53cd43311d-cb3f1b710e82":{"id":"ea53cd43311d-cb3f1b710e82","user":{"type":"id","generated":false,"id":"User:cb3f1b710e82","typename":"User"},"state":"visible","__typename":"Collaborator"},"User:cb3f1b710e82":{"id":"cb3f1b710e82","name":"Kiarash Irandoust","__typename":"User"},"$Post:ea53cd43311d.previewContent":{"subtitle":"This article demonstrates how Apache Spark can be utilised for ETL Python.","__typename":"PreviewContent"},"programming":{"name":"Programming","slug":"programming","__typename":"Topic"}}</script><script src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/manifest.js"></script><script src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/vendorsmain.js"></script><script src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/main.js"></script><script src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/vendorsscreen.js"></script>
<script src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/screen_004.js"></script>
<script src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/screen_002.js"></script>
<script src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/screen.js"></script>
<script src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/screen_003.js"></script><script>window.main();</script><script src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/16180790160.js" async=""></script><script src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/p.js" async="" id="parsely-cf"></script><iframe src="How%20to%20create%20a%20simple%20ETL%20Job%20locally%20with%20PySpark,%20PostgreSQL%20and%20Docker_files/a16180790160.htm" aria-hidden="true" tabindex="-1" title="Optimizely Internal Frame" style="display: none;" width="0" hidden="" height="0"></iframe></body></html>